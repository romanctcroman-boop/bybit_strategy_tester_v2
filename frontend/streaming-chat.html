<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net https://unpkg.com; style-src 'self' https://cdn.jsdelivr.net https://fonts.googleapis.com 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' https://cdn.jsdelivr.net https://fonts.gstatic.com; connect-src 'self' https://api.bybit.com wss://stream.bybit.com ws://localhost:* http://localhost:*; frame-src 'none'; object-src 'none'; base-uri 'self'; form-action 'self'; frame-ancestors 'none'">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta name="referrer" content="strict-origin-when-cross-origin">

    <title>AI Studio - Bybit Strategy Tester v2</title>
    <link rel="stylesheet" href="./css/streaming_chat.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <a href="dashboard.html" class="home-link">ğŸ  Dashboard</a>
            </div>
            <h1>ğŸ§  AI Studio</h1>
            <p>Strategy Generation â€¢ Market Research â€¢ Risk Analysis</p>
        </header>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-btn active" data-tab="strategy" onclick="switchTab('strategy')">
                <span class="tab-icon">ğŸ¯</span>
                <span class="tab-label">Strategy Generator</span>
            </button>
            <button class="tab-btn" data-tab="research" onclick="switchTab('research')">
                <span class="tab-icon">ğŸ”</span>
                <span class="tab-label">Market Research</span>
            </button>
            <button class="tab-btn" data-tab="risk" onclick="switchTab('risk')">
                <span class="tab-icon">âš ï¸</span>
                <span class="tab-label">Risk Analysis</span>
            </button>
        </div>

        <!-- Strategy Generator Tab -->
        <div class="tab-content active" id="tab-strategy">
            <div class="quick-prompts">
                <button class="quick-prompt" onclick="usePrompt('Generate a momentum-based trading strategy for BTC with 4H timeframe')">ğŸ“ˆ Momentum Strategy</button>
                <button class="quick-prompt" onclick="usePrompt('Create a mean reversion strategy for altcoins using Bollinger Bands')">ğŸ“Š Mean Reversion</button>
                <button class="quick-prompt" onclick="usePrompt('Design a scalping strategy for high-volatility pairs with 5m timeframe')">âš¡ Scalping Strategy</button>
                <button class="quick-prompt" onclick="usePrompt('Build a breakout strategy with volume confirmation for ETH')">ğŸš€ Breakout Strategy</button>
            </div>
        </div>

        <!-- Market Research Tab -->
        <div class="tab-content" id="tab-research">
            <div class="quick-prompts">
                <button class="quick-prompt" onclick="usePrompt('Analyze current Bitcoin market sentiment and key support/resistance levels')">ğŸ“° BTC Sentiment</button>
                <button class="quick-prompt" onclick="usePrompt('What are the latest developments in Ethereum ecosystem affecting ETH price?')">ğŸ”· ETH News</button>
                <button class="quick-prompt" onclick="usePrompt('Identify top performing altcoins this week and potential catalysts')">ğŸŒŸ Top Altcoins</button>
                <button class="quick-prompt" onclick="usePrompt('Analyze macro economic factors affecting crypto markets')">ğŸŒ Macro Analysis</button>
            </div>
        </div>

        <!-- Risk Analysis Tab -->
        <div class="tab-content" id="tab-risk">
            <div class="quick-prompts">
                <button class="quick-prompt" onclick="usePrompt('Calculate optimal position size for my portfolio with 2% risk per trade')">ğŸ“ Position Sizing</button>
                <button class="quick-prompt" onclick="usePrompt('Analyze correlation between my BTC, ETH, and SOL positions')">ğŸ”— Correlation Analysis</button>
                <button class="quick-prompt" onclick="usePrompt('Review my strategy risk parameters and suggest improvements')">ğŸ” Risk Review</button>
                <button class="quick-prompt" onclick="usePrompt('Calculate maximum drawdown scenarios for current market conditions')">ğŸ“‰ Drawdown Analysis</button>
            </div>
        </div>

        <div class="controls">
            <div class="control-group">
                <label for="agent-select">Agent:</label>
                <select id="agent-select" title="Select AI Agent">
                    <option value="deepseek">DeepSeek V3.2</option>
                    <option value="perplexity">Perplexity</option>
                </select>
            </div>

            <div class="control-group">
                <label for="thinking-mode">Thinking Mode:</label>
                <label class="toggle">
                    <input type="checkbox" id="thinking-mode" title="Enable Chain-of-Thought reasoning" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </div>

        <div class="chat-container" id="chat-container">
            <div class="status" id="status">Not connected</div>
        </div>

        <div class="input-container">
            <textarea 
                id="prompt-input" 
                placeholder="Enter your question..."
                rows="3"
            ></textarea>
            <button id="send-btn">Send</button>
        </div>

        <div class="stats">
            <div class="stat">
                <div class="stat-value" id="reasoning-chars">0</div>
                <div class="stat-label">Reasoning Chars</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="content-chars">0</div>
                <div class="stat-label">Content Chars</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="latency">0</div>
                <div class="stat-label">Latency (ms)</div>
            </div>
        </div>
    </div>

    <!-- History Toggle Button -->
    <button class="history-toggle" onclick="toggleHistory()" title="Chat History">ğŸ“œ</button>

    <!-- History Panel -->
    <div class="history-panel" id="history-panel">
        <div class="history-header">
            <h3>ğŸ’¬ Chat History</h3>
            <button class="history-close" onclick="toggleHistory()">Ã—</button>
        </div>
        <div id="history-list">
            <div class="history-empty">
                <p>No saved conversations</p>
                <p class="history-empty-sub">Your conversations will appear here</p>
            </div>
        </div>
        <button class="sync-btn" onclick="manualSync()" title="Sync with server">ğŸ”„ Sync</button>
    </div>

    <script type="module" src="./js/pages/streaming_chat.js"></script>
</body>
</html>