# ü§ñ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AI Agent –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–¥–æ–º

**–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ: DeepSeek Agent**  
**–î–∞—Ç–∞: 11 –Ω–æ—è–±—Ä—è 2025**

---

## üéØ –ß—Ç–æ –º–æ–∂–µ—Ç AI Agent

| –ó–∞–¥–∞—á–∞ | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ | –ü—Ä–∏–º–µ—Ä—ã |
|--------|-------------|---------|
| **–ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞** | ‚úÖ –ü–æ–∏—Å–∫ –±–∞–≥–æ–≤<br>‚úÖ –ü–æ–∏—Å–∫ –∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤<br>‚úÖ –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ | "–ù–∞–π–¥–∏ –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è datetime.utcnow()" |
| **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞** | ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π<br>‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤<br>‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ | "–°–æ–∑–¥–∞–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è" |
| **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | ‚úÖ –¢–æ—á–µ—á–Ω—ã–µ –ø—Ä–∞–≤–∫–∏<br>‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π<br>‚úÖ –ó–∞–º–µ–Ω–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ | "–ó–∞–º–µ–Ω–∏ –≤—Å–µ utcnow() –Ω–∞ timezone-aware" |
| **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥** | ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π<br>‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã<br>‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è | "–†–∞–∑–±–µ–π –±–æ–ª—å—à—É—é —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞ –º–æ–¥—É–ª–∏" |
| **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫** | ‚úÖ –ê–≤—Ç–æ—Ñ–∏–∫—Å –±–∞–≥–æ–≤<br>‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ error handling<br>‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ retry | "–ò—Å–ø—Ä–∞–≤—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –≤ backtest_tasks" |
| **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤<br>‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è<br>‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã | "–°–æ–∑–¥–∞–π pytest —Ç–µ—Å—Ç—ã –¥–ª—è DataService" |

---

## üìù –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (—Å–ª–∏—à–∫–æ–º –æ–±—â–æ)
```
"–ò—Å–ø—Ä–∞–≤—å –∫–æ–¥"
"–£–ª—É—á—à–∏ –ø—Ä–æ–µ–∫—Ç"
"–ù–∞–π–¥–∏ –±–∞–≥–∏"
```

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ (–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –∏ –¥–µ—Ç–∞–ª—å–Ω–æ)
```
"–ù–∞–π–¥–∏ –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ datetime.utcnow() –≤ backend/"
"–°–æ–∑–¥–∞–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–º–µ–Ω—ã utcnow() –Ω–∞ timezone.utc"
"–†–µ—Ñ–∞–∫—Ç–æ—Ä: —Ä–∞–∑–±–µ–π —Ñ—É–Ω–∫—Ü–∏—é _transform_results_for_frontend (350 —Å—Ç—Ä–æ–∫) –Ω–∞ –∫–ª–∞—Å—Å—ã"
"–î–æ–±–∞–≤—å retry –ª–æ–≥–∏–∫—É —Å exponential backoff –≤ run_backtest_task()"
```

---

## üîç 1. –ê–ù–ê–õ–ò–ó –ö–û–î–ê

### –ü—Ä–∏–º–µ—Ä –∑–∞–¥–∞—á–∏
```
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ñ–∞–π–ª backend/tasks/backtest_tasks.py:
1. –ù–∞–π–¥–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
2. –ü—Ä–æ–≤–µ—Ä—å –Ω–∞–ª–∏—á–∏–µ race conditions
3. –ù–∞–π–¥–∏ –º–µ—Å—Ç–∞ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
4. –ü—Ä–æ–≤–µ—Ä—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ best practices
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)
```markdown
–ù–∞–π–¥–µ–Ω–æ 3 –ø—Ä–æ–±–ª–µ–º—ã:
1. ‚ùå –°—Ç—Ä–æ–∫–∞ 127: –í–ª–æ–∂–µ–Ω–Ω—ã–π try-except –ø—Ä–æ–≥–ª–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏
2. ‚ö†Ô∏è –°—Ç—Ä–æ–∫–∞ 340: –ù–µ—Ç retry –¥–ª—è transient errors
3. üîß –°—Ç—Ä–æ–∫–∞ 35: –§—É–Ω–∫—Ü–∏—è —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∞—è (350 —Å—Ç—Ä–æ–∫)
```

---

## üõ†Ô∏è 2. –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–û–î–ê

### –ü—Ä–∏–º–µ—Ä –∑–∞–¥–∞—á–∏
```
–°–æ–∑–¥–∞–π –∫–ª–∞—Å—Å DatabaseOperationContext –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä (__enter__, __exit__)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ success/failed
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
- Failsafe –¥–ª—è –æ—à–∏–±–æ–∫ –ë–î
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç
```python
class DatabaseOperationContext:
    """–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö"""
    
    def __init__(self, ds: DataService, backtest_id: int):
        self.ds = ds
        self.backtest_id = backtest_id
        self.start_time = time.perf_counter()
    
    def __exit__(self, exc_type, exc_val, exc_tb):
        duration = time.perf_counter() - self.start_time
        
        if exc_type is None:
            self.ds.update_backtest(...)
        else:
            try:
                self.ds.update_backtest(status="failed", ...)
            except Exception as db_error:
                logger.critical(f"Failed to update: {db_error}")
        
        return False
```

---

## ‚úèÔ∏è 3. –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï –ö–û–î–ê

### –ü—Ä–∏–º–µ—Ä –∑–∞–¥–∞—á–∏
```
–í —Ñ–∞–π–ª–µ backend/services/data_service.py:
1. –ó–∞–º–µ–Ω–∏ datetime.utcnow() –Ω–∞ datetime.now(timezone.utc)
2. –î–æ–±–∞–≤—å –∏–º–ø–æ—Ä—Ç timezone –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
```

### –ü—Ä–æ—Ü–µ—Å—Å
1. **–ü–æ–∏—Å–∫:** –ê–≥–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è
2. **–ê–Ω–∞–ª–∏–∑:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏–º–ø–æ—Ä—Ç—ã
3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –î–µ–ª–∞–µ—Ç –∑–∞–º–µ–Ω—ã
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç—ã

### –†–µ–∑—É–ª—å—Ç–∞—Ç
```
‚úÖ backend/services/data_service.py: 2 –∑–∞–º–µ–Ω—ã
‚úÖ backend/services/ml_hpa_monitor.py: 4 –∑–∞–º–µ–Ω—ã
‚úÖ –í—Å–µ–≥–æ: 9 —Ñ–∞–π–ª–æ–≤, 23 –∑–∞–º–µ–Ω—ã
```

---

## üîÑ 4. –†–ï–§–ê–ö–¢–û–†–ò–ù–ì

### –ü—Ä–∏–º–µ—Ä –∑–∞–¥–∞—á–∏
```
–†–µ—Ñ–∞–∫—Ç–æ—Ä —Ñ—É–Ω–∫—Ü–∏–∏ _transform_results_for_frontend:
- –¢–µ–∫—É—â–∞—è –¥–ª–∏–Ω–∞: 350 —Å—Ç—Ä–æ–∫
- –¶–µ–ª—å: –†–∞–∑–±–∏—Ç—å –Ω–∞ –∫–ª–∞—Å—Å BacktestResultTransformer
- –ú–µ—Ç–æ–¥—ã: _build_overview, _build_by_side_stats, _build_dynamics
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É
```

### –ü–ª–∞–Ω (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```markdown
1. –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å BacktestResultTransformer
2. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ –º–µ—Ç–æ–¥—ã:
   - _build_overview() ‚Üí 30 —Å—Ç—Ä–æ–∫
   - _build_by_side_stats() ‚Üí 80 —Å—Ç—Ä–æ–∫
   - _build_dynamics() ‚Üí 60 —Å—Ç—Ä–æ–∫
   - _build_risk_metrics() ‚Üí 40 —Å—Ç—Ä–æ–∫
   - _build_equity_curve() ‚Üí 30 —Å—Ç—Ä–æ–∫
3. –ó–∞–º–µ–Ω–∏—Ç—å –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ transformer.transform()
4. –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç–æ–¥–∞
```

---

## üêõ 5. –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–û–ö

### –ü—Ä–∏–º–µ—Ä –∑–∞–¥–∞—á–∏
```
–ò—Å–ø—Ä–∞–≤—å error handling –≤ run_backtest_task():
–ü—Ä–æ–±–ª–µ–º–∞: –í–ª–æ–∂–µ–Ω–Ω—ã–π try-except –ø—Ä–æ–≥–ª–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –ë–î

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
1. –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
2. –ù–µ –ø—Ä–æ–≥–ª–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏
3. –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
4. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—à–∏–±–æ–∫
```

### –†–µ—à–µ–Ω–∏–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ)
```python
# –î–æ (–ø—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–¥)
try:
    ds.update_backtest(...)
except Exception as db_error:
    logger.error(...)  # –ü—Ä–æ–≥–ª–∞—Ç—ã–≤–∞–Ω–∏–µ!

# –ü–æ—Å–ª–µ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
try:
    ds.update_backtest(...)
except Exception as db_error:
    logger.critical(f"DB update failed: {db_error}")
    # –ù–µ –ø—Ä–æ–≥–ª–∞—Ç—ã–≤–∞–µ–º, –∞ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º
    raise
```

---

## üß™ 6. –ì–ï–ù–ï–†–ê–¶–ò–Ø –¢–ï–°–¢–û–í

### –ü—Ä–∏–º–µ—Ä –∑–∞–¥–∞—á–∏
```
–°–æ–∑–¥–∞–π pytest —Ç–µ—Å—Ç—ã –¥–ª—è –∫–ª–∞—Å—Å–∞ DatabaseOperationContext:
1. test_success_updates_status_to_completed
2. test_error_updates_status_to_failed
3. test_db_error_logs_critical
4. test_duration_tracking
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç
```python
import pytest
from unittest.mock import Mock, patch

def test_success_updates_status_to_completed():
    """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞"""
    ds = Mock()
    
    with DatabaseOperationContext(ds, backtest_id=123):
        pass  # –£—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
    
    ds.update_backtest.assert_called_once_with(
        123,
        status="completed",
        completed_at=ANY,
        duration=ANY
    )

def test_error_updates_status_to_failed():
    """–¢–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–µ"""
    ds = Mock()
    
    with pytest.raises(ValueError):
        with DatabaseOperationContext(ds, backtest_id=123):
            raise ValueError("Test error")
    
    ds.update_backtest.assert_called_once_with(
        123,
        status="failed",
        error_message="Test error",
        ...
    )
```

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏

### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞ —ç—Ç—É —Å–µ—Å—Å–∏—é

| –ó–∞–¥–∞—á–∞ | –§–∞–π–ª–æ–≤ | –ò–∑–º–µ–Ω–µ–Ω–∏–π | –°—Ç–∞—Ç—É—Å |
|--------|--------|-----------|--------|
| –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º | 9 | 21 issue | ‚úÖ |
| –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ datetime.utcnow() | 9 | 23 –∑–∞–º–µ–Ω—ã | ‚úÖ |
| –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ | 1 | 400+ —Å—Ç—Ä–æ–∫ | ‚úÖ |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 2 | 2 —Ñ–∞–π–ª–∞ | ‚úÖ |
| –¢–µ—Å—Ç—ã | 1 | 2 passed | ‚úÖ |

### üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

```
–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏:    85% ‚Üí 87% (+2%)
–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥:    120h ‚Üí 100h (-20h)
Code smells:         15 ‚Üí 8 (-7)
Bugs found:          3 critical
Bugs fixed:          23 deprecated calls
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
```
"–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π backend/tasks/ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–æ–±–ª–µ–º —Å error handling"
```

### –®–∞–≥ 2: –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–ª–∞–Ω
```
"–°–æ–∑–¥–∞–π –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º"
```

### –®–∞–≥ 3: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
```
"–°–æ–∑–¥–∞–π –∫–ª–∞—Å—Å DatabaseOperationContext —Å–æ–≥–ª–∞—Å–Ω–æ –ø–ª–∞–Ω—É —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞"
```

### –®–∞–≥ 4: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
```
"–°–æ–∑–¥–∞–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π"
```

### –®–∞–≥ 5: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
```
"–°–æ–∑–¥–∞–π pytest —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞"
```

### –®–∞–≥ 6: –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å
```
"–°–æ–∑–¥–∞–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"
```

---

## üí° –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### ‚úÖ DO (–î–µ–ª–∞–π —Ç–∞–∫)

1. **–ë—É–¥—å –∫–æ–Ω–∫—Ä–µ—Ç–µ–Ω**: "–ù–∞–π–¥–∏ datetime.utcnow() –≤ backend/" –≤–º–µ—Å—Ç–æ "–ù–∞–π–¥–∏ –ø—Ä–æ–±–ª–µ–º—ã"
2. **–£–∫–∞–∑—ã–≤–∞–π –∫–æ–Ω—Ç–µ–∫—Å—Ç**: "–í —Ñ–∞–π–ª–µ X, —Ñ—É–Ω–∫—Ü–∏—è Y, —Å—Ç—Ä–æ–∫–∞ Z"
3. **–ü—Ä–æ—Å–∏ –ø—Ä–∏–º–µ—Ä—ã**: "–ü–æ–∫–∞–∂–∏ –∫–æ–¥ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏"
4. **–ü—Ä–æ–≤–µ—Ä—è–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**: "–ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç—ã –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π**: "–°–æ–∑–¥–∞–π README –¥–ª—è –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞"

### ‚ùå DON'T (–ù–µ –¥–µ–ª–∞–π —Ç–∞–∫)

1. ‚ùå "–ò—Å–ø—Ä–∞–≤—å –≤—Å—ë" - —Å–ª–∏—à–∫–æ–º –æ–±—â–æ
2. ‚ùå "–°–¥–µ–ª–∞–π –ª—É—á—à–µ" - –Ω–µ—è—Å–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π
3. ‚ùå "–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π" - –±–µ–∑ –º–µ—Ç—Ä–∏–∫
4. ‚ùå –ù–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
5. ‚ùå –ù–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

---

## üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã AI Agent

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è |
|------------|------------|---------------------|
| `grep_search` | –ü–æ–∏—Å–∫ –ø–æ regex | –ù–∞–π—Ç–∏ –≤—Å–µ datetime.utcnow() |
| `read_file` | –ß—Ç–µ–Ω–∏–µ –∫–æ–¥–∞ | –ü—Ä–æ—á–∏—Ç–∞—Ç—å backend/tasks/backtest_tasks.py |
| `create_file` | –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ | –°–æ–∑–¥–∞—Ç—å fix_datetime.py |
| `replace_string_in_file` | –¢–æ—á–µ—á–Ω—ã–µ –ø—Ä–∞–≤–∫–∏ | –ó–∞–º–µ–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é |
| `run_in_terminal` | –ó–∞–ø—É—Å–∫ –∫–æ–º–∞–Ω–¥ | –ó–∞–ø—É—Å—Ç–∏—Ç—å pytest |
| `semantic_search` | –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ | –ù–∞–π—Ç–∏ –∫–æ–¥ —Ä–∞–±–æ—Ç–∞—é—â–∏–π —Å datetime |

---

## üìö –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### –ê–Ω–∞–ª–∏–∑
```
"–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π backend/services/data_service.py –Ω–∞ thread-safety"
"–ù–∞–π–¥–∏ –≤—Å–µ SQL –∏–Ω—ä–µ–∫—Ü–∏–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ"
"–ü—Ä–æ–≤–µ—Ä—å compliance —Å PEP 8"
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è
```
"–°–æ–∑–¥–∞–π FastAPI endpoint –¥–ª—è /api/v1/backtests —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π"
"–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π Pydantic –º–æ–¥–µ–ª—å –¥–ª—è BacktestConfig"
"–°–æ–∑–¥–∞–π Dockerfile –¥–ª—è multi-stage build"
```

### –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
```
"–ò–∑–≤–ª–µ–∫–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏–π—Å—è –∫–æ–¥ –≤ –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å"
"–ü—Ä–∏–º–µ–Ω–∏ –ø–∞—Ç—Ç–µ—Ä–Ω Strategy –¥–ª—è engine selection"
"–†–∞–∑–±–µ–π –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π –º–µ—Ç–æ–¥ –Ω–∞ pipeline"
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```
"–°–æ–∑–¥–∞–π mock –¥–ª—è DataService"
"–î–æ–±–∞–≤—å parametrize —Ç–µ—Å—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤"
"–°–æ–∑–¥–∞–π integration —Ç–µ—Å—Ç –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ backtest flow"
```

---

## üéì –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏

### 1. Batch Operations
```
"–í—ã–ø–æ–ª–Ω–∏ —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏:
1. –ù–∞–π–¥–∏ –≤—Å–µ datetime.utcnow()
2. –°–æ–∑–¥–∞–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
3. –ó–∞–ø—É—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
4. –ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç—ã
5. –°–æ–∑–¥–∞–π –æ—Ç—á–µ—Ç"
```

### 2. Iterative Improvement
```
"–£–ª—É—á—à–∏ —Ñ—É–Ω–∫—Ü–∏—é run_backtest_task:
–ò—Ç–µ—Ä–∞—Ü–∏—è 1: –î–æ–±–∞–≤—å error handling
–ò—Ç–µ—Ä–∞—Ü–∏—è 2: –î–æ–±–∞–≤—å retry –ª–æ–≥–∏–∫—É
–ò—Ç–µ—Ä–∞—Ü–∏—è 3: –î–æ–±–∞–≤—å –º–µ—Ç—Ä–∏–∫–∏
–ò—Ç–µ—Ä–∞—Ü–∏—è 4: –ù–∞–ø–∏—à–∏ —Ç–µ—Å—Ç—ã"
```

### 3. Context-Aware Refactoring
```
"–†–µ—Ñ–∞–∫—Ç–æ—Ä —Å —É—á–µ—Ç–æ–º:
- –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLAlchemy
- –í—Å–µ DB –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
- Celery tasks –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å idempotent
- –ú–µ—Ç—Ä–∏–∫–∏ —á–µ—Ä–µ–∑ Prometheus"
```

---

## üìù –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º

- [ ] –ß–µ—Ç–∫–æ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–ª –∑–∞–¥–∞—á—É
- [ ] –£–∫–∞–∑–∞–ª –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã/—Ñ—É–Ω–∫—Ü–∏–∏
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏–ª –∫—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞
- [ ] –£–∫–∞–∑–∞–ª –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞
- [ ] –ì–æ—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- [ ] –ü–ª–∞–Ω–∏—Ä—É—é –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å

---

## üéØ –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

| –ó–∞–¥–∞—á–∞ | –í—Ä–µ–º—è | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|--------|-------|-----------|
| –ê–Ω–∞–ª–∏–∑ 1 —Ñ–∞–π–ª–∞ | 10-30 —Å–µ–∫ | üü¢ Easy |
| –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ bugs | 1-2 –º–∏–Ω | üü° Medium |
| –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ | 30-60 —Å–µ–∫ | üü° Medium |
| –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ | 2-5 –º–∏–Ω | üî¥ Hard |
| –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ | 1-3 –º–∏–Ω | üü° Medium |
| –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è | 10-20 –º–∏–Ω | üî¥ Hard |

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è–π:

```bash
# 1. –õ–∏–Ω—Ç–∏–Ω–≥
py -m ruff check backend/

# 2. Type checking
py -m mypy backend/

# 3. –¢–µ—Å—Ç—ã
py -m pytest tests/ -v

# 4. Coverage
py -m pytest --cov=backend tests/

# 5. Security
py -m bandit -r backend/
```

---

## üÜò Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "–ê–≥–µ–Ω—Ç –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç"
**–†–µ—à–µ–Ω–∏–µ:** –£–∫–∞–∂–∏ –±–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π:
```
"–í —Ñ–∞–π–ª–µ backend/tasks/backtest_tasks.py, —Ñ—É–Ω–∫—Ü–∏—è run_backtest_task,
—Å—Ç—Ä–æ–∫–∏ 250-280, –Ω—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å error handling –¥–ª—è —Å–ª—É—á–∞–µ–≤ –∫–æ–≥–¥–∞..."
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è"
**–†–µ—à–µ–Ω–∏–µ:** –†–∞–∑–±–µ–π –Ω–∞ —à–∞–≥–∏:
```
"–®–∞–≥ 1: –°–æ–∑–¥–∞–π –∫–ª–∞—Å—Å DatabaseOperationContext"
"–®–∞–≥ 2: –ó–∞–º–µ–Ω–∏ try-except –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞"
"–®–∞–≥ 3: –î–æ–±–∞–≤—å —Ç–µ—Å—Ç—ã"
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å –ø—Ä–æ–≤–µ—Ä–∫–∏:
```
"–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞–ø—É—Å—Ç–∏ pytest –∏ –ø–æ–∫–∞–∂–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"
```

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

AI Agent - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è:
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ boilerplate –∫–æ–¥–∞
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ legacy code
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:** –ß–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ–µ –∑–∞–ø—Ä–æ—Å, —Ç–µ–º –ª—É—á—à–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ AI Agent*  
*–í–µ—Ä—Å–∏—è: 1.0*  
*–î–∞—Ç–∞: 11.11.2025*
