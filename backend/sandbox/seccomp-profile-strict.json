{
  "comment": "Strict Seccomp Profile for AI-Generated Code Sandbox - Production Mode",
  "description": "Blocks dangerous syscalls like kernel modules, reboot, mount, etc.",
  "defaultAction": "SCMP_ACT_ERRNO",
  "defaultErrnoRet": 1,
  "archMap": [
    {
      "architecture": "SCMP_ARCH_X86_64",
      "subArchitectures": ["SCMP_ARCH_X86", "SCMP_ARCH_X32"]
    }
  ],
  "syscalls": [
    {
      "comment": "Essential syscalls for Python/JavaScript execution",
      "names": [
        "read", "write", "open", "openat", "close",
        "stat", "fstat", "lstat", "poll", "lseek",
        "mmap", "mprotect", "munmap", "brk",
        "rt_sigaction", "rt_sigprocmask", "rt_sigreturn",
        "ioctl", "pread64", "pwrite64", "readv", "writev",
        "access", "pipe", "select", "sched_yield",
        "mremap", "msync", "mincore", "madvise",
        "dup", "dup2", "pause", "nanosleep",
        "getitimer", "alarm", "setitimer", "getpid",
        "sendfile", "socket", "connect", "accept",
        "sendto", "recvfrom", "sendmsg", "recvmsg",
        "shutdown", "bind", "listen", "getsockname",
        "getpeername", "socketpair", "setsockopt", "getsockopt",
        "clone", "fork", "vfork", "execve",
        "exit", "exit_group", "wait4", "kill",
        "uname", "fcntl", "flock", "fsync",
        "fdatasync", "truncate", "ftruncate", "getdents",
        "getcwd", "chdir", "fchdir", "rename",
        "mkdir", "rmdir", "creat", "link",
        "unlink", "symlink", "readlink", "chmod",
        "fchmod", "chown", "fchown", "lchown",
        "umask", "gettimeofday", "getrlimit", "getrusage",
        "sysinfo", "times", "ptrace", "getuid",
        "syslog", "getgid", "setuid", "setgid",
        "geteuid", "getegid", "setpgid", "getppid",
        "getpgrp", "setsid", "setreuid", "setregid",
        "getgroups", "setgroups", "setresuid", "getresuid",
        "setresgid", "getresgid", "getpgid", "setfsuid",
        "setfsgid", "getsid", "capget", "capset",
        "rt_sigpending", "rt_sigtimedwait", "rt_sigqueueinfo",
        "rt_sigsuspend", "sigaltstack", "utime", "mknod",
        "uselib", "personality", "ustat", "statfs",
        "fstatfs", "sysfs", "getpriority", "setpriority",
        "sched_setparam", "sched_getparam", "sched_setscheduler",
        "sched_getscheduler", "sched_get_priority_max",
        "sched_get_priority_min", "sched_rr_get_interval",
        "mlock", "munlock", "mlockall", "munlockall",
        "vhangup", "modify_ldt", "pivot_root",
        "prctl", "arch_prctl", "adjtimex", "setrlimit",
        "chroot", "sync", "acct", "settimeofday",
        "clock_gettime", "clock_getres", "clock_nanosleep",
        "timer_create", "timer_settime", "timer_gettime",
        "timer_getoverrun", "timer_delete", "epoll_create",
        "epoll_ctl", "epoll_wait", "remap_file_pages",
        "set_tid_address", "set_thread_area", "get_thread_area",
        "semget", "semop", "semctl", "msgget",
        "msgsnd", "msgrcv", "msgctl", "shmget",
        "shmat", "shmctl", "shmdt", "futex"
      ],
      "action": "SCMP_ACT_ALLOW"
    },
    {
      "comment": "BLOCKED: Kernel module operations",
      "names": [
        "create_module", "init_module", "delete_module",
        "finit_module", "query_module"
      ],
      "action": "SCMP_ACT_KILL",
      "errnoRet": 1
    },
    {
      "comment": "BLOCKED: System reboot/shutdown",
      "names": ["reboot", "kexec_load", "kexec_file_load"],
      "action": "SCMP_ACT_KILL",
      "errnoRet": 1
    },
    {
      "comment": "BLOCKED: Filesystem mounting",
      "names": ["mount", "umount", "umount2", "pivot_root"],
      "action": "SCMP_ACT_KILL",
      "errnoRet": 1
    },
    {
      "comment": "BLOCKED: Kernel debugging/tracing",
      "names": [
        "ptrace", "process_vm_readv", "process_vm_writev",
        "kcmp", "perf_event_open"
      ],
      "action": "SCMP_ACT_KILL",
      "errnoRet": 1
    },
    {
      "comment": "BLOCKED: BPF operations",
      "names": ["bpf"],
      "action": "SCMP_ACT_KILL",
      "errnoRet": 1
    },
    {
      "comment": "BLOCKED: Keyring operations",
      "names": [
        "add_key", "request_key", "keyctl"
      ],
      "action": "SCMP_ACT_KILL",
      "errnoRet": 1
    },
    {
      "comment": "BLOCKED: Namespace operations",
      "names": ["unshare", "setns"],
      "action": "SCMP_ACT_KILL",
      "errnoRet": 1
    }
  ]
}
