# ‚úÖ Strategy Builder - –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ

> **–î–∞—Ç–∞**: 2026-01-29  
> **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ

```powershell
py -3.14 scripts/apply_strategy_builder_migration.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ **–£—Å–ø–µ—à–Ω–æ**

### –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—è

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|------|-----|----------|--------|
| `builder_graph` | JSON | –ü–æ–ª–Ω—ã–π –≥—Ä–∞—Ñ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ | ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω |
| `builder_blocks` | JSON | –ú–∞—Å—Å–∏–≤ –±–ª–æ–∫–æ–≤ | ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω |
| `builder_connections` | JSON | –ú–∞—Å—Å–∏–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π | ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω |
| `is_builder_strategy` | BOOLEAN | –§–ª–∞–≥ builder-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ | ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω |

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã

| –ò–Ω–¥–µ–∫—Å | –¢–∞–±–ª–∏—Ü–∞ | –ü–æ–ª—è | –°—Ç–∞—Ç—É—Å |
|--------|---------|------|--------|
| `ix_strategies_is_builder_strategy` | `strategies` | `is_builder_strategy` | ‚úÖ –°–æ–∑–¥–∞–Ω |

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–µ–π

```sql
PRAGMA table_info(strategies);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Å–µ 4 –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `strategies`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤

```sql
SELECT name FROM sqlite_master 
WHERE type='index' AND name LIKE '%is_builder_strategy%';
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ò–Ω–¥–µ–∫—Å `ix_strategies_is_builder_strategy` —Å–æ–∑–¥–∞–Ω

---

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ú–µ—Ç–æ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

–ò–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å multiple heads –≤ Alembic, –º–∏–≥—Ä–∞—Ü–∏—è –±—ã–ª–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ SQL:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `sqlalchemy.text()` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL-–∑–∞–ø—Ä–æ—Å–æ–≤
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (`engine.begin()`)
- –ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω–∞—è –≤ `alembic_version`

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª–µ–π

```sql
ALTER TABLE strategies ADD COLUMN builder_graph JSON;
ALTER TABLE strategies ADD COLUMN builder_blocks JSON;
ALTER TABLE strategies ADD COLUMN builder_connections JSON;
ALTER TABLE strategies ADD COLUMN is_builder_strategy BOOLEAN NOT NULL DEFAULT 0;
CREATE INDEX ix_strategies_is_builder_strategy ON strategies(is_builder_strategy);
```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏

- [x] ‚úÖ –ü–æ–ª—è `builder_graph`, `builder_blocks`, `builder_connections`, `is_builder_strategy` —Å–æ–∑–¥–∞–Ω—ã
- [x] ‚úÖ –ò–Ω–¥–µ–∫—Å `ix_strategies_is_builder_strategy` —Å–æ–∑–¥–∞–Ω
- [x] ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω–∞—è –≤ `alembic_version`
- [x] ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–∏

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏:

1. ‚úÖ **–ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞** - –ø–æ–ª—è –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü–µ `strategies`
2. ‚è≥ **–†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ UI** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É Strategy Builder
3. ‚è≥ **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫—É

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏](./STRATEGY_BUILDER_MIGRATION_AND_E2E.md)
- [–û—Ç—á–µ—Ç –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ](./STRATEGY_BUILDER_PROGRESS_REPORT.md)
- [–ü–ª–∞–Ω —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤](./STRATEGY_BUILDER_NEXT_STEPS.md)

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **MIGRATION APPLIED**  
**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é**: –î–∞
