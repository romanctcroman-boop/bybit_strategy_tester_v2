# Multi-Agent AI Architecture Ğ´Ğ»Ñ VS Code

## ğŸ¯ ĞĞ±Ğ·Ğ¾Ñ€

ĞœÑƒĞ»ÑŒÑ‚Ğ¸Ğ°Ğ³ĞµĞ½Ñ‚Ğ½Ğ°Ñ AI-Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ° Ğ´Ğ»Ñ VS Code, Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€ÑƒÑÑ‰Ğ°Ñ:
- **GitHub Copilot** - IDE-Ğ°ÑÑĞ¸ÑÑ‚ĞµĞ½Ñ‚, Ğ°Ğ²Ñ‚Ğ¾Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ
- **DeepSeek API** - ĞºĞ¾Ğ´Ğ¾Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ, Ñ€ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³, Ğ³Ğ»ÑƒĞ±Ğ¾ĞºĞ¸Ğ¹ reasoning
- **Perplexity Sonar Pro** - Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·, research, Ğ°ÑƒĞ´Ğ¸Ñ‚

Ğ’ÑĞµ Ğ°Ğ³ĞµĞ½Ñ‚Ñ‹ Ğ¾Ğ±ÑŠĞµĞ´Ğ¸Ğ½ĞµĞ½Ñ‹ Ñ‡ĞµÑ€ĞµĞ· **MCP Router** - Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€ Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹ Ğ¸ fallback Ğ¼ĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼Ğ¾Ğ¼.

## ğŸ“ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        VS Code                              â”‚
â”‚  (Hotkeys, Tasks, Commands, Selection, Terminal)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MCP Router                               â”‚
â”‚  â€¢ ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸                                            â”‚
â”‚  â€¢ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ                            â”‚
â”‚  â€¢ Fallback Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸                                 â”‚
â”‚  â€¢ Pipeline execution                                       â”‚
â”‚  â€¢ Request logging (request_id)                            â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚              â”‚
     â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Copilot â”‚   â”‚ DeepSeek â”‚   â”‚ Sonar Pro  â”‚
â”‚         â”‚   â”‚   API    â”‚   â”‚    API     â”‚
â”‚ (VS Ext)â”‚   â”‚          â”‚   â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

### 1. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° API ĞºĞ»ÑÑ‡ĞµĞ¹

```bash
# .env Ñ„Ğ°Ğ¹Ğ»
PERPLEXITY_API_KEY=pplx-xxxxx
DEEPSEEK_API_KEY=sk-xxxxx
```

### 2. Ğ—Ğ°Ğ¿ÑƒÑĞº MCP ÑĞµÑ€Ğ²ĞµÑ€Ğ°

```bash
cd mcp-server
python server.py
```

### 3. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ· VS Code

#### Ğ§ĞµÑ€ĞµĞ· Tasks (Ctrl+Shift+P â†’ "Tasks: Run Task")
- **AI: Generate Code (DeepSeek)** - Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ĞºĞ¾Ğ´Ğ°
- **AI: Refactor Code (DeepSeek)** - Ğ ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ°
- **AI: Analyze Logic (Sonar Pro)** - ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸ ĞºĞ¾Ğ´Ğ°
- **AI: Code Review Workflow** - ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ code review pipeline
- **AI: Strategy Development Workflow** - Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ²Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸

#### Ğ§ĞµÑ€ĞµĞ· Hotkeys
- `Ctrl+Shift+G` - Generate Code
- `Ctrl+Shift+R` - Refactor Code
- `Ctrl+Shift+A` - Analyze Logic
- `Ctrl+Shift+E` - Explain Code (Ğ½Ğ° Ğ²Ñ‹Ğ´ĞµĞ»ĞµĞ½Ğ½Ğ¾Ğ¼ Ñ‚ĞµĞºÑÑ‚Ğµ)
- `Ctrl+Shift+D` - Generate Documentation
- `Ctrl+Shift+W Ctrl+Shift+C` - Code Review Workflow
- `Ctrl+Shift+W Ctrl+Shift+S` - Strategy Development Workflow
- `Ctrl+Shift+W Ctrl+Shift+R` - Refactor with Audit Workflow

#### Ğ§ĞµÑ€ĞµĞ· CLI

```bash
# Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ĞºĞ¾Ğ´Ğ°
python mcp-server/vscode_integration.py \
  --task code-generation \
  --prompt "Create a FastAPI endpoint for user authentication"

# Ğ ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ñ„Ğ°Ğ¹Ğ»Ğ°
python mcp-server/vscode_integration.py \
  --task refactoring \
  --file backend/api/app.py

# ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸
python mcp-server/vscode_integration.py \
  --task logic-analysis \
  --file backend/services/data_service.py

# Workflow: Code Review
python mcp-server/vscode_integration.py \
  --workflow code-review \
  --file backend/core/backtest.py
```

## ğŸ¯ Ğ¢Ğ¸Ğ¿Ñ‹ Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ¸ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

### Copilot Tasks
| Task Type | Description | Primary Agent | Fallback |
|-----------|-------------|---------------|----------|
| `context-completion` | ĞĞ²Ñ‚Ğ¾Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ´Ğ° | Copilot | - |
| `ide-integration` | Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ IDE/Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğ¾Ğ¼ | Copilot | - |
| `quick-fix` | Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ | Copilot | DeepSeek |

### DeepSeek Tasks
| Task Type | Description | Primary Agent | Fallback |
|-----------|-------------|---------------|----------|
| `code-generation` | Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ĞºĞ¾Ğ´Ğ° | DeepSeek | Copilot |
| `refactoring` | Ğ ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ | DeepSeek | - |
| `deep-reasoning` | Ğ“Ğ»ÑƒĞ±Ğ¾ĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· | DeepSeek | Sonar Pro |
| `batch-operations` | ĞœĞ°ÑÑĞ¾Ğ²Ñ‹Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ | DeepSeek | - |
| `documentation` | Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ğ¸ | DeepSeek | Sonar Pro |

### Sonar Pro Tasks
| Task Type | Description | Primary Agent | Fallback |
|-----------|-------------|---------------|----------|
| `logic-analysis` | ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸ | Sonar Pro | DeepSeek |
| `audit` | ĞÑƒĞ´Ğ¸Ñ‚ ĞºĞ¾Ğ´Ğ°/Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹ | Sonar Pro | - |
| `research` | Ğ˜ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ¿Ğ¾Ğ¸ÑĞº | Sonar Pro | - |
| `explain` | ĞĞ±ÑŠÑÑĞ½ĞµĞ½Ğ¸Ñ | Sonar Pro | - |
| `strategy-review` | Ğ ĞµĞ²ÑŒÑ Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ²Ñ‹Ñ… ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¹ | Sonar Pro | DeepSeek |

## ğŸ”„ Pipeline Workflows

### 1. Code Review Workflow

```json
{
  "steps": [
    {
      "name": "analyze_logic",
      "task_type": "logic-analysis",
      "agent": "sonar-pro",
      "data": {"query": "Analyze code logic and potential issues"}
    },
    {
      "name": "generate_improvements",
      "task_type": "code-generation",
      "agent": "deepseek",
      "data": {"prompt": "Generate improved version based on analysis"}
    },
    {
      "name": "create_summary",
      "task_type": "explain",
      "agent": "sonar-pro",
      "data": {"query": "Summarize improvements"}
    }
  ]
}
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:**
```bash
python mcp-server/vscode_integration.py \
  --workflow code-review \
  --file backend/core/backtest.py
```

### 2. Strategy Development Workflow

```json
{
  "steps": [
    {
      "name": "research_approach",
      "task_type": "research",
      "agent": "sonar-pro",
      "data": {"query": "Research RSI mean reversion strategies"}
    },
    {
      "name": "generate_code",
      "task_type": "code-generation",
      "agent": "deepseek",
      "data": {"prompt": "Generate Python strategy class"}
    },
    {
      "name": "create_documentation",
      "task_type": "documentation",
      "agent": "deepseek",
      "data": {"prompt": "Create comprehensive documentation"}
    }
  ]
}
```

### 3. Refactor with Audit Workflow

```json
{
  "steps": [
    {
      "name": "refactor",
      "task_type": "refactoring",
      "agent": "deepseek"
    },
    {
      "name": "audit",
      "task_type": "audit",
      "agent": "sonar-pro"
    },
    {
      "name": "final_improvements",
      "task_type": "code-generation",
      "agent": "deepseek"
    }
  ]
}
```

## ğŸ”Œ MCP Tools

### 1. multi_agent_route

Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡.

```python
await multi_agent_route(
    task_type="code-generation",
    prompt="Create a FastAPI endpoint",
    context={"framework": "FastAPI", "auth": "JWT"}
)
```

**Response:**
```json
{
  "request_id": "550e8400-e29b-41d4-a716-446655440000",
  "task_type": "code-generation",
  "agent": "deepseek",
  "status": "success",
  "result": "# Generated code here...",
  "metadata": {
    "execution_time": 2.34,
    "model": "deepseek-coder",
    "usage": {"tokens": 450}
  }
}
```

### 2. multi_agent_pipeline

Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ñ†ĞµĞ¿Ğ¾Ñ‡ĞºĞ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡.

```python
await multi_agent_pipeline(
    steps=[
        {"name": "analyze", "task_type": "logic-analysis", ...},
        {"name": "improve", "task_type": "code-generation", ...}
    ]
)
```

### 3. list_available_agents

Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ²ÑĞµÑ… Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ² Ğ¸ Ğ¸Ñ… Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ĞµĞ¹.

```python
await list_available_agents()
```

### 4. get_routing_info

Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸.

```python
await get_routing_info(task_type="code-generation")
```

**Response:**
```json
{
  "task_type": "code-generation",
  "primary_agent": "deepseek",
  "fallback_agents": ["copilot"],
  "total_agents": 2,
  "auto_fallback": true
}
```

## ğŸ› ï¸ Advanced Features

### Context Preprocessing

MCP Router Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚:
- AST Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· (Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞµ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ)
- Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
- Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ git (Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞµ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ)
- Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸

### Fallback Mechanism

Ğ•ÑĞ»Ğ¸ primary agent Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ğ¸Ğ»Ğ¸ Ğ¾ÑˆĞ¸Ğ±Ğ°ĞµÑ‚ÑÑ:
1. ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ fallback Ğ½Ğ° ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ agent
2. Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº
3. Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ° Ğ¾Ñ‚ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ³Ğ¾ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°

```python
# ĞŸÑ€Ğ¸Ğ¼ĞµÑ€: code-generation
# Primary: DeepSeek â†’ Fallback: Copilot

# Ğ•ÑĞ»Ğ¸ DeepSeek Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½
{
  "primary_agent": "deepseek",
  "status": "error",
  "fallback_to": "copilot"
}
```

### Request Logging

ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ `request_id`:

```json
{
  "request_id": "550e8400-e29b-41d4-a716-446655440000",
  "timestamp": "2025-10-31T14:30:00",
  "task_type": "code-generation",
  "agent": "deepseek",
  "status": "success",
  "execution_time": 2.34
}
```

Ğ›Ğ¾Ğ³Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑÑ‚ÑÑ Ğ´Ğ»Ñ Ğ´Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ¸ Ğ¸ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸.

## ğŸ“ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

### 1. Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ĞºĞ¾Ğ´Ğ° Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ¼

```python
result = await multi_agent_route(
    task_type="code-generation",
    prompt="Create a FastAPI endpoint for user registration",
    context={
        "framework": "FastAPI",
        "database": "PostgreSQL",
        "auth": "JWT",
        "validation": "Pydantic"
    }
)
```

### 2. ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ²Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸

```python
result = await multi_agent_route(
    task_type="strategy-review",
    query="Review this RSI mean reversion strategy for edge cases",
    context={"code": open("strategy.py").read()}
)
```

### 3. ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ workflow Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸

```bash
# 1. Research
python vscode_integration.py \
  --task research \
  --prompt "Best practices for async FastAPI endpoints"

# 2. Generate
python vscode_integration.py \
  --task code-generation \
  --prompt "Create async endpoint based on research"

# 3. Review
python vscode_integration.py \
  --workflow code-review \
  --file api/endpoints/users.py
```

## ğŸ”’ Security \& Rate Limiting

### API Keys Management
- Ğ¥Ñ€Ğ°Ğ½Ğ¸Ğ¼ Ğ² `.env` Ñ„Ğ°Ğ¹Ğ»Ğµ
- **ĞĞ• ĞºĞ¾Ğ¼Ğ¼Ğ¸Ñ‚Ğ¸Ğ¼** Ğ² git
- Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ secure storage

### Rate Limiting
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ retry Ñ backoff
- Fallback Ğ½Ğ° Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ Ğ°Ğ³ĞµĞ½Ñ‚Ñ‹
- Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ rate limit errors

## ğŸ§ª Testing

### Unit Tests

```bash
pytest mcp-server/tests/test_router.py
```

### Integration Tests

```bash
# Test Ñ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ API
pytest mcp-server/tests/test_integration.py --api-keys

# Test Ñ Ğ¼Ğ¾ĞºĞ°Ğ¼Ğ¸
pytest mcp-server/tests/test_integration.py
```

## ğŸ“Š Monitoring \& Analytics

### Request Stats

```python
# ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸
router = get_router()
stats = router.request_logs

# ĞĞ½Ğ°Ğ»Ğ¸Ğ· ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ÑÑ‚Ğ¸ Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ²
success_rate = {
    "deepseek": count_success("deepseek") / total,
    "sonar-pro": count_success("sonar-pro") / total
}
```

## ğŸ”® Future Enhancements

### Planned Features
1. **AST Preprocessing** - Ğ“Ğ»ÑƒĞ±Ğ¾ĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹ ĞºĞ¾Ğ´Ğ°
2. **Git Integration** - ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹
3. **Project Graph** - Ğ“Ñ€Ğ°Ñ„ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
4. **Custom Agents** - ĞŸĞ»Ğ°Ğ³Ğ¸Ğ½Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ´Ğ»Ñ Ğ½Ğ¾Ğ²Ñ‹Ñ… AI API
5. **Web Dashboard** - UI Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° Ğ¸ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ
6. **Streaming Responses** - Real-time Ğ²Ñ‹Ğ²Ğ¾Ğ´ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
7. **Collaborative Pipelines** - Ğ¡Ğ¾Ğ²Ğ¼ĞµÑÑ‚Ğ½Ñ‹Ğµ workflows

## ğŸ“š API Reference

### TaskType Enum

```python
class TaskType(str, Enum):
    # Copilot
    CONTEXT_COMPLETION = "context-completion"
    IDE_INTEGRATION = "ide-integration"
    QUICK_FIX = "quick-fix"
    
    # DeepSeek
    CODE_GENERATION = "code-generation"
    REFACTORING = "refactoring"
    DEEP_REASONING = "deep-reasoning"
    BATCH_OPERATIONS = "batch-operations"
    DOCUMENTATION = "documentation"
    
    # Sonar Pro
    LOGIC_ANALYSIS = "logic-analysis"
    AUDIT = "audit"
    RESEARCH = "research"
    EXPLAIN = "explain"
    STRATEGY_REVIEW = "strategy-review"
    
    # Pipeline
    PIPELINE = "pipeline"
    MULTI_AGENT = "multi-agent"
```

### AgentType Enum

```python
class AgentType(str, Enum):
    COPILOT = "copilot"
    DEEPSEEK = "deepseek"
    SONAR_PRO = "sonar-pro"
```

## ğŸ¤ Contributing

### Adding New Agents

1. Create client class:
```python
class NewAgentClient(BaseAgentClient):
    async def process(self, data: Dict[str, Any]) -> Dict[str, Any]:
        # Implementation
        pass
```

2. Register in router:
```python
self.new_agent_client = NewAgentClient()
```

3. Add to routing table:
```python
self.task_routing[TaskType.NEW_TASK] = [AgentType.NEW_AGENT]
```

## ğŸ“„ License

MIT License - ÑĞ¼. LICENSE Ñ„Ğ°Ğ¹Ğ»

## ğŸ“ Support

- GitHub Issues: [bybit_strategy_tester_v2/issues](https://github.com/RomanCTC/bybit_strategy_tester_v2/issues)
- Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ: `docs/MULTI_AGENT.md`
- MCP Server Logs: `logs/mcp-server-startup.log`

---

**Version:** 1.0.0  
**Last Updated:** October 31, 2025  
**Status:** âœ… Production Ready
