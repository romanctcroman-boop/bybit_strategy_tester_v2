# üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: –≠–≤–æ–ª—é—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–∞–º—è—Ç–∏ AI-–∞–≥–µ–Ω—Ç–æ–≤

> **–í–µ—Ä—Å–∏—è:** 1.0  
> **–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2026-02-04  
> **–ü—Ä–æ–µ–∫—Ç:** Bybit Strategy Tester v2  
> **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** HIGH ‚Äî –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–∞–∑–≤–∏—Ç–∏–µ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç–∏ –∞–≥–µ–Ω—Ç–æ–≤  
> **–†–∞—Å—á—ë—Ç–Ω—ã–π –æ–±—ä—ë–º —Ä–∞–±–æ—Ç:** 5 —Ñ–∞–∑, ~40-60 —á–∞—Å–æ–≤

---

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–†–µ–∑—é–º–µ](#1-—Ä–µ–∑—é–º–µ)
2. [–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (AS-IS)](#2-—Ç–µ–∫—É—â–µ–µ-—Å–æ—Å—Ç–æ—è–Ω–∏–µ-as-is)
3. [–í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã](#3-–≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã)
4. [–¶–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (TO-BE)](#4-—Ü–µ–ª–µ–≤–æ–µ-—Å–æ—Å—Ç–æ—è–Ω–∏–µ-to-be)
5. [–§–∞–∑—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#5-—Ñ–∞–∑—ã-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
    - [–§–∞–∑–∞ P1: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è MemoryItem](#—Ñ–∞–∑–∞-p1-—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è-memoryitem)
    - [–§–∞–∑–∞ P2: MCP-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–∞–º—è—Ç–∏](#—Ñ–∞–∑–∞-p2-mcp-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã-–ø–∞–º—è—Ç–∏)
    - [–§–∞–∑–∞ P3: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä —Ç–µ–≥–æ–≤ + –∞–≤—Ç–æ-—Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ñ–∞–∑–∞-p3-–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä-—Ç–µ–≥–æ–≤--–∞–≤—Ç–æ-—Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
    - [–§–∞–∑–∞ P4: –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ (Hybrid Retrieval)](#—Ñ–∞–∑–∞-p4-–≥–∏–±—Ä–∏–¥–Ω—ã–π-–ø–æ–∏—Å–∫-hybrid-retrieval)
    - [–§–∞–∑–∞ P5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ –≤ –¥–µ–ª–∏–±–µ—Ä–∞—Ü–∏—é](#—Ñ–∞–∑–∞-p5-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-–ø–∞–º—è—Ç–∏-–≤-–¥–µ–ª–∏–±–µ—Ä–∞—Ü–∏—é)
6. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ü–µ–ª–µ–≤–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è](#6-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Ü–µ–ª–µ–≤–æ–≥–æ-—Ä–µ—à–µ–Ω–∏—è)
7. [–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞](#7-–º–µ—Ç—Ä–∏–∫–∏-—É—Å–ø–µ—Ö–∞)
8. [–†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è](#8-—Ä–∏—Å–∫–∏-–∏-–º–∏—Ç–∏–≥–∞—Ü–∏—è)
9. [–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏](#9-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
10. [–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#10-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)

---

## 1. –†–µ–∑—é–º–µ

### –ö–æ–Ω—Ç–µ–∫—Å—Ç

–°–∏—Å—Ç–µ–º–∞ AI-–∞–≥–µ–Ω—Ç–æ–≤ Bybit Strategy Tester v2 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é –ø–∞–º—è—Ç—å** –∏–∑ 4-—Ö —É—Ä–æ–≤–Ω–µ–π, –≤–¥–æ—Ö–Ω–æ–≤–ª—ë–Ω–Ω—É—é –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π (ACT-R, LIDA). –ê—É–¥–∏—Ç Phase 13 –≤—ã—è–≤–∏–ª **5 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º** –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ Phase 13b (GAM, Memp, Repos) –¥–∞–ª–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é.

### –¶–µ–ª—å

–≠–≤–æ–ª—é—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–∞–º—è—Ç–∏ –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è **"5-6/10 –∑—Ä–µ–ª–æ—Å—Ç–∏"** (–æ—Ü–µ–Ω–∫–∞ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞ —Ç—Ä—ë—Ö –∞–≥–µ–Ω—Ç–æ–≤) –¥–æ —É—Ä–æ–≤–Ω—è **"8/10 –∑—Ä–µ–ª–æ—Å—Ç–∏"**, –≥–¥–µ:

- –ê–≥–µ–Ω—Ç—ã –º–æ–≥—É—Ç **—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ** —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å –∑–Ω–∞–Ω–∏—è —á–µ—Ä–µ–∑ MCP-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- –ü–∞–º—è—Ç—å **—É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞** ‚Äî –µ–¥–∏–Ω–∞—è –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è **—Ä–∞–±–æ—Ç–∞–µ—Ç** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
- –ü–æ–∏—Å–∫ **–≥–∏–±—Ä–∏–¥–Ω—ã–π** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π + BM25 + –≤–µ–∫—Ç–æ—Ä–Ω—ã–π
- –î–µ–ª–∏–±–µ—Ä–∞—Ü–∏—è **–æ–±–æ–≥–∞—â–µ–Ω–∞** –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∏–∑ –ø–∞–º—è—Ç–∏

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞—É–¥–∏—Ç–∞

| –ò—Å—Ç–æ—á–Ω–∏–∫                      | –£—á–∞—Å—Ç–Ω–∏–∫–∏                  | –†–µ–∑—É–ª—å—Ç–∞—Ç                          |
| ----------------------------- | -------------------------- | ---------------------------------- |
| Phase 13: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞—É–¥–∏—Ç | DeepSeek, Qwen, Perplexity | 5 –∫–æ–Ω—Å–µ–Ω—Å—É—Å-–ø—Ä–æ–±–ª–µ–º, –æ—Ü–µ–Ω–∫–∞ 5-6/10 |
| Phase 13b: –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ SOTA  | DeepSeek, Qwen, Perplexity | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏–∑ GAM/Memp/Repos     |
| Phase 12: –û–±—É—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏     | 9/9 —Ç–µ—Å—Ç–æ–≤, 222/222 checks | 100% ‚Äî –∞–≥–µ–Ω—Ç—ã –∑–Ω–∞—é—Ç API            |

---

## 2. –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (AS-IS)

### 2.1. –ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤

| –§–∞–π–ª                                           | –°—Ç—Ä–æ–∫    | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                             |
| ---------------------------------------------- | -------- | ---------------------------------------------------------------------- |
| `backend/agents/memory/hierarchical_memory.py` | 811      | –Ø–¥—Ä–æ: HierarchicalMemory, MemoryItem, MemoryTier, MemoryConsolidator   |
| `backend/agents/memory/sqlite_backend.py`      | 352      | SQLite-–ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏—è: SQLiteMemoryBackend, **PersistentMemoryItem**     |
| `backend/agents/memory/backend_interface.py`   | 215      | ABC MemoryBackend, JsonFileBackend, SQLiteBackendAdapter               |
| `backend/agents/memory/shared_memory.py`       | 624      | –ú–µ–∂–∞–≥–µ–Ω—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: SharedMemory, Transaction, ConflictResolution   |
| `backend/agents/memory/vector_store.py`        | 602      | –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫: VectorMemoryStore + ChromaDB                          |
| `backend/agents/memory/__init__.py`            | 30       | –≠–∫—Å–ø–æ—Ä—Ç: HierarchicalMemory, MemoryItem, MemoryTier, VectorMemoryStore |
| **–ò—Ç–æ–≥–æ**                                      | **2634** |                                                                        |

### 2.2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

#### MemoryItem (hierarchical_memory.py, —Å—Ç—Ä–æ–∫–∞ 55)

```python
@dataclass
class MemoryItem:
    id: str
    content: str
    memory_type: MemoryType          # Enum: WORKING/EPISODIC/SEMANTIC/PROCEDURAL
    created_at: datetime              # datetime —Å UTC
    accessed_at: datetime             # datetime —Å UTC
    access_count: int = 0
    importance: float = 0.5           # 0.0‚Äì1.0
    embedding: list[float] | None     # –í–µ–∫—Ç–æ—Ä (384 dim, MiniLM)
    metadata: dict[str, Any]
    tags: list[str]
    source: str | None
    related_ids: list[str]
```

#### PersistentMemoryItem (sqlite_backend.py, —Å—Ç—Ä–æ–∫–∞ 30)

```python
@dataclass
class PersistentMemoryItem:
    id: str
    content: str
    memory_type: str                  # –°—Ç—Ä–æ–∫–∞, –Ω–µ Enum!
    importance: float = 0.5
    created_at: float                 # timestamp (time.time()), –Ω–µ datetime!
    accessed_at: float                # timestamp (time.time()), –Ω–µ datetime!
    access_count: int = 0
    ttl_seconds: float = 3600.0       # –ù–µ—Ç –≤ MemoryItem
    tags: list[str]
    metadata: dict[str, Any]
    # –ù–ï–¢: embedding, source, related_ids
```

### 2.3. –£—Ä–æ–≤–Ω–∏ –ø–∞–º—è—Ç–∏

| –£—Ä–æ–≤–µ–Ω—å    | max_items | TTL      | consolidation_threshold | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
| ---------- | --------- | -------- | ----------------------- | --------- |
| WORKING    | 10        | 5 –º–∏–Ω    | 0.7                     | 1         |
| EPISODIC   | 1000      | 7 –¥–Ω–µ–π   | 0.6                     | 2         |
| SEMANTIC   | 10000     | 365 –¥–Ω–µ–π | 0.5                     | 3         |
| PROCEDURAL | 500       | 10 –ª–µ—Ç   | 0.8                     | 4         |

### 2.4. –û–ø–µ—Ä–∞—Ü–∏–∏ HierarchicalMemory

| –û–ø–µ—Ä–∞—Ü–∏—è        | –û–ø–∏—Å–∞–Ω–∏–µ                                                                         | –°—Ç—Ä–æ–∫–∞ |
| --------------- | -------------------------------------------------------------------------------- | ------ |
| `store()`       | –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π tier, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç ID –∏–∑ SHA256+timestamp            | 239    |
| `recall()`      | –ü–æ–∏—Å–∫ –ø–æ query —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ (tier, importance, tags, semantic)                    | 305    |
| `get()`         | –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ ID                                                                  | 377    |
| `delete()`      | –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ ID                                                                   | 386    |
| `consolidate()` | WORKING‚ÜíEPISODIC (importance‚â•0.7), EPISODIC‚ÜíSEMANTIC (3+ —Å –æ–¥–Ω–∏–º —Ç–µ–≥–æ–º, avg‚â•0.6) | 396    |
| `forget()`      | TTL-expiration + decay 0.1%/—á–∞—Å + evict (importance<0.1, access<2)               | 477    |
| `get_stats()`   | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ tier'–∞–º                                                            | 719    |

### 2.5. –§–æ—Ä–º—É–ª–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ (recall)

```
score = 0.3 √ó keyword_overlap + 0.5 √ó cosine_similarity + 0.1 √ó importance + 0.1 √ó recency
```

### 2.6. –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏—è

```
HierarchicalMemory
    ‚îî‚îÄ‚îÄ backend: MemoryBackend (ABC)
            ‚îú‚îÄ‚îÄ JsonFileBackend (legacy, default) ‚Äî —Ñ–∞–π–ª-–Ω–∞-—ç–ª–µ–º–µ–Ω—Ç
            ‚îî‚îÄ‚îÄ SQLiteBackendAdapter ‚Üí wraps SQLiteMemoryBackend (via asyncio.to_thread)
```

### 2.7. MCP-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (—Ç–µ–∫—É—â–∏–µ)

| –§–∞–π–ª                            | –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã                               | –ü–∞–º—è—Ç—å? |
| ------------------------------- | ----------------------------------------- | ------- |
| `mcp/tools/strategy_builder.py` | builder_get/create/update/delete_strategy | ‚ùå      |
| `mcp/tools/backtest.py`         | run_backtest, get_backtest_metrics        | ‚ùå      |
| `mcp/tools/indicators.py`       | calculate_rsi/macd/bb/atr, analyze_trend  | ‚ùå      |
| `mcp/tools/risk.py`             | calculate_position_size, risk_reward      | ‚ùå      |
| `mcp/tools/strategy.py`         | list/validate/evolve_strategies           | ‚ùå      |
| `mcp/tools/system.py`           | –°–∏—Å—Ç–µ–º–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã                         | ‚ùå      |

**‚ö†Ô∏è –ù–û–õ–¨ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–∞–º—è—Ç—å—é –∞–≥–µ–Ω—Ç–æ–≤.**

### 2.8. –ú–µ–∂–∞–≥–µ–Ω—Ç–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è

| –ö–∞–Ω–∞–ª        | –ö–ª–∞—Å—Å                    | –§–∞–π–ª                           | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                   |
| ------------ | ------------------------ | ------------------------------ | ---------------------------- |
| SharedMemory | SharedMemory             | shared_memory.py               | In-process thread-safe state |
| Redis        | AgentToAgentCommunicator | agent_to_agent_communicator.py | Cross-process messaging      |
| LangGraph    | LangGraphOrchestrator    | langgraph_orchestrator.py      | Graph-based workflow         |

**‚ö†Ô∏è –ù–µ—Ç —á—ë—Ç–∫–æ–≥–æ —Ä–æ—É—Ç–∏–Ω–≥–∞ ‚Äî –∫–∞–∫–æ–π –∫–∞–Ω–∞–ª –¥–ª—è –∫–∞–∫–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è.**

---

## 3. –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ1: –î—É–∞–ª—å–Ω—ã–π MemoryItem (CRITICAL)

**–°—É—Ç—å:** –î–≤–∞ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö dataclass'–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ü–µ–ø—Ç–∞.

| –ê—Å–ø–µ–∫—Ç        | MemoryItem          | PersistentMemoryItem  |
| ------------- | ------------------- | --------------------- |
| `memory_type` | `MemoryType` (Enum) | `str`                 |
| `created_at`  | `datetime` (UTC)    | `float` (time.time()) |
| `accessed_at` | `datetime` (UTC)    | `float` (time.time()) |
| `embedding`   | ‚úÖ `list[float]`    | ‚ùå –ù–µ—Ç                |
| `source`      | ‚úÖ `str`            | ‚ùå –ù–µ—Ç                |
| `related_ids` | ‚úÖ `list[str]`      | ‚ùå –ù–µ—Ç                |
| `ttl_seconds` | ‚ùå –ù–µ—Ç (TTL –≤ tier) | ‚úÖ `float`            |

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- SQLiteBackendAdapter —Ç–µ—Ä—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ (embedding, source, related_ids)
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ silent data corruption
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –≥—Ä–∞—Ñ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –ø–∞–º—è—Ç–∏

**–ö–æ–Ω—Å–µ–Ω—Å—É—Å:** 3/3 –∞–≥–µ–Ω—Ç–∞ –æ—Ç–º–µ—Ç–∏–ª–∏ –∫–∞–∫ HIGH severity.

---

### –ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ MCP-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø–∞–º—è—Ç–∏ (CRITICAL)

**–°—É—Ç—å:** –ê–≥–µ–Ω—Ç—ã –∑–Ω–∞—é—Ç API –ø–∞–º—è—Ç–∏ (–æ–±—É—á–µ–Ω—ã –≤ Phase 12), –Ω–æ –Ω–µ –∏–º–µ—é—Ç MCP tools –¥–ª—è –µ–≥–æ –≤—ã–∑–æ–≤–∞.

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**

- 6 MCP tools –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ (strategy, backtest, indicators, risk)
- 0 MCP tools –¥–ª—è `memory.store()`, `memory.recall()`, `memory.get_stats()`
- –ê–≥–µ–Ω—Ç—ã –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ **–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥**, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç –ø–∞–º—è—Ç—å, –Ω–æ –Ω–µ –º–æ–≥—É—Ç **–Ω–∞–ø—Ä—è–º—É—é** –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- –ê–≥–µ–Ω—Ç—ã –Ω–µ –º–æ–≥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
- –ü–æ—Ç–µ—Ä—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –∑–∞–¥–∞—á
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–∞ –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –∞–≥–µ–Ω—Ç–æ–≤ —Å –ø–∞–º—è—Ç—å—é

**–ö–æ–Ω—Å–µ–Ω—Å—É—Å:** 3/3 ‚Äî HIGH, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞.

---

### –ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ3: –¢–µ–≥-–∏–Ω–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ü–∏—è –±–ª–æ–∫–∏—Ä—É–µ—Ç –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—é (HIGH)

**–°—É—Ç—å:** –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è EPISODIC‚ÜíSEMANTIC —Ç—Ä–µ–±—É–µ—Ç ‚â•3 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å **–æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Ç–µ–≥–æ–º**, –Ω–æ –Ω–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ–≥–æ–≤.

**–ü—Ä–∏–º–µ—Ä –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:**

```
–≠–ª–µ–º–µ–Ω—Ç 1: tags=["rsi", "trading"]          # –∞–≥–µ–Ω—Ç DeepSeek
–≠–ª–µ–º–µ–Ω—Ç 2: tags=["RSI_indicator", "trade"]   # –∞–≥–µ–Ω—Ç Qwen
–≠–ª–µ–º–µ–Ω—Ç 3: tags=["rsi-strategy", "Trading"]  # –∞–≥–µ–Ω—Ç Perplexity
```

‚Üí –£ –∫–∞–∂–¥–æ–≥–æ —Ç–µ–≥–∞ count=1, –ø–æ—Ä–æ–≥ 3 –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç ‚Üí **–∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è –ù–ò–ö–û–ì–î–ê –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**.

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- EPISODIC tier –∑–∞—Å–æ—Ä—è–µ—Ç—Å—è (–¥–æ max 1000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
- SEMANTIC tier –æ—Å—Ç–∞—ë—Ç—Å—è –ø—É—Å—Ç—ã–º
- –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –Ω–µ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è

---

### –ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ4: –î–µ–≥—Ä–∞–¥–∞—Ü–∏—è VectorStore (MEDIUM)

**–°—É—Ç—å:** ChromaDB –∏ sentence-transformers ‚Äî optional dependencies. –ü—Ä–∏ –∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–∏—Å—Ç–µ–º–∞ –º–æ–ª—á–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ keyword-only search.

**–¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**

```python
# VectorMemoryStore.__init__:
self.use_local_embeddings = use_local_embeddings  # default=True
# –ù–æ –µ—Å–ª–∏ chromadb –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚Üí try/except ‚Üí –º–æ–ª—á–∞–ª–∏–≤—ã–π fallback
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–Ω–∞–µ—Ç, —á—Ç–æ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –æ—Ç–∫–ª—é—á—ë–Ω
- `recall()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ `0.3 √ó keyword_overlap` –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π —Ñ–æ—Ä–º—É–ª—ã
- –ö–∞—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞ –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç –Ω–∞ ~70% –±–µ–∑ —Å–µ–º–∞–Ω—Ç–∏–∫–∏

---

### –ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ5: 3 –∫–∞–Ω–∞–ª–∞ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –±–µ–∑ —Ä–æ—É—Ç–∏–Ω–≥–∞ (MEDIUM)

**–°—É—Ç—å:** SharedMemory (in-process), Redis (cross-process), LangGraph (workflow) ‚Äî –Ω–µ—Ç –µ–¥–∏–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–µ–≥–æ, –∫–∞–∫–æ–π –∫–∞–Ω–∞–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Å–∞–º —Ä–µ—à–∞–µ—Ç, –∫–∞–∫–æ–π –∫–∞–Ω–∞–ª ‚Äî risk of inconsistency
- –î—É–±–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–∏ –æ—à–∏–±–æ—á–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –¥–≤—É—Ö –∫–∞–Ω–∞–ª–æ–≤
- –ù–µ—Ç fallback –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Redis

---

## 4. –¶–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (TO-BE)

### 4.1. –¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    MCP Memory Tools                         ‚îÇ
‚îÇ  memory_store  memory_recall  memory_stats  memory_forget   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              HierarchicalMemory v2                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇWORKING ‚îÇ‚Üí‚îÇEPISODIC ‚îÇ‚Üí‚îÇSEMANTIC  ‚îÇ‚Üí‚îÇPROCEDURAL    ‚îÇ      ‚îÇ
‚îÇ  ‚îÇmax=10  ‚îÇ ‚îÇmax=1000 ‚îÇ ‚îÇmax=10000 ‚îÇ ‚îÇmax=500       ‚îÇ      ‚îÇ
‚îÇ  ‚îÇTTL=5m  ‚îÇ ‚îÇTTL=7d   ‚îÇ ‚îÇTTL=365d  ‚îÇ ‚îÇTTL=10yr      ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  + agent_namespace (per-agent isolation)                    ‚îÇ
‚îÇ  + TagNormalizer (canonical tags + synonyms)                ‚îÇ
‚îÇ  + AutoTagger (metadata ‚Üí tags)                             ‚îÇ
‚îÇ  + UnifiedMemoryItem (single dataclass)                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ             Unified Persistence Layer                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ SQLiteBackend    ‚îÇ  ‚îÇ VectorMemoryStore         ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ (single schema)  ‚îÇ  ‚îÇ (ChromaDB + MiniLM)       ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ + degradation warning      ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Hybrid Retrieval Engine                         ‚îÇ
‚îÇ  Stage 1: Structured filter (tier, namespace, importance)   ‚îÇ
‚îÇ  Stage 2: BM25 keyword ranking                              ‚îÇ
‚îÇ  Stage 3: Vector cosine similarity (if available)           ‚îÇ
‚îÇ  Stage 4: Fusion scoring + re-ranking                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ            Deliberation Integration                          ‚îÇ
‚îÇ  auto_recall ‚Üí inject context ‚Üí RealLLMDeliberation          ‚îÇ
‚îÇ  auto_store ‚Üí save insights after consensus                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 4.2. –ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è TO-BE –æ—Ç AS-IS

| –ê—Å–ø–µ–∫—Ç           | AS-IS                                           | TO-BE                                 |
| ---------------- | ----------------------------------------------- | ------------------------------------- |
| –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö    | 2 dataclass (MemoryItem + PersistentMemoryItem) | 1 UnifiedMemoryItem                   |
| –ê–≥–µ–Ω—Ç—Å–∫–∏–π –¥–æ—Å—Ç—É–ø | –¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∫–æ–¥                                | MCP tools (store/recall/stats/forget) |
| –¢–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ      | –°–≤–æ–±–æ–¥–Ω–æ–µ, –±–µ–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏                     | TagNormalizer + AutoTagger + —Å–∏–Ω–æ–Ω–∏–º—ã |
| –ü–æ–∏—Å–∫            | keyword (30%) + cosine (50%)                    | BM25 + structured + cosine (3-stage)  |
| –î–µ–≥—Ä–∞–¥–∞—Ü–∏—è       | –ú–æ–ª—á–∞–ª–∏–≤–∞—è                                      | –Ø–≤–Ω—ã–π warning + metric logging        |
| –ò–∑–æ–ª—è—Ü–∏—è         | –û–±—â–∏–π store –¥–ª—è –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤                    | agent_namespace (per-agent view)      |
| –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è     | –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –∏–∑-–∑–∞ —Ç–µ–≥–æ–≤                         | –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ canonical tags         |

---

## 5. –§–∞–∑—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

### –§–∞–∑–∞ P1: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è MemoryItem

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL  
**–°—Ä–æ–∫:** 8-10 —á–∞—Å–æ–≤  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç (–±–∞–∑–æ–≤–∞—è —Ñ–∞–∑–∞)

#### –¶–µ–ª—å

–£—Å—Ç—Ä–∞–Ω–∏—Ç—å –¥—É–∞–ª—å–Ω—ã–π anti-pattern –¥–≤—É—Ö dataclass –∏ —Å–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—É—é –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π agent namespace.

#### –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç

##### P1.1. –°–æ–∑–¥–∞–Ω–∏–µ UnifiedMemoryItem (3 —á–∞—Å–∞)

**–§–∞–π–ª:** `backend/agents/memory/hierarchical_memory.py`

–ó–∞–º–µ–Ω–∏—Ç—å `MemoryItem` –∏ `PersistentMemoryItem` –Ω–∞ –µ–¥–∏–Ω—ã–π dataclass:

```python
@dataclass
class UnifiedMemoryItem:
    # –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    id: str
    agent_namespace: str = "shared"       # NEW: per-agent isolation

    # –ö–æ–Ω—Ç–µ–Ω—Ç
    content: str
    memory_type: MemoryType               # Enum (–Ω–µ str!)

    # –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ (–≤—Å–µ–≥–¥–∞ datetime UTC)
    created_at: datetime
    accessed_at: datetime

    # –ü–æ–≤–µ–¥–µ–Ω–∏–µ
    access_count: int = 0
    importance: float = 0.5               # 0.0‚Äì1.0
    ttl_seconds: float | None = None      # None = use tier default

    # –°–µ–º–∞–Ω—Ç–∏–∫–∞
    embedding: list[float] | None = None  # 384 dim MiniLM
    tags: list[str] = field(default_factory=list)    # normalized tags
    metadata: dict[str, Any] = field(default_factory=dict)

    # –°–≤—è–∑–∏
    source: str | None = None
    related_ids: list[str] = field(default_factory=list)
```

–ó–∞–¥–∞—á–∏:

1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å `UnifiedMemoryItem` –≤ `hierarchical_memory.py`
2. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã `to_dict()`, `from_dict()`, `is_expired()`, `update_access()`
3. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é (importance 0-1, memory_type is Enum)
4. –î–æ–±–∞–≤–∏—Ç—å `agent_namespace` —Å default `"shared"` –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

##### P1.2. –ú–∏–≥—Ä–∞—Ü–∏—è SQLite-—Å—Ö–µ–º—ã (2 —á–∞—Å–∞)

**–§–∞–π–ª:** `backend/agents/memory/sqlite_backend.py`

–ó–∞–¥–∞—á–∏:

1. –û–±–Ω–æ–≤–∏—Ç—å CREATE TABLE —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏: `agent_namespace`, `embedding BLOB`, `source`, `related_ids JSON`
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `datetime` –≤–º–µ—Å—Ç–æ `float` –¥–ª—è timestamps (ISO-8601 —Å—Ç—Ä–æ–∫–∏)
3. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã: `(agent_namespace, memory_type)`, `(agent_namespace, importance DESC)`
4. –ù–∞–ø–∏—Å–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –µ—Å—Ç—å)
5. –£–¥–∞–ª–∏—Ç—å `PersistentMemoryItem` dataclass ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `UnifiedMemoryItem`

##### P1.3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ SQLiteBackendAdapter (2 —á–∞—Å–∞)

**–§–∞–π–ª:** `backend/agents/memory/backend_interface.py`

–ó–∞–¥–∞—á–∏:

1. `save_item()` ‚Äî —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –í–°–ï –ø–æ–ª—è UnifiedMemoryItem (–≤–∫–ª—é—á–∞—è embedding, source, related_ids)
2. `load_item()` ‚Äî –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ –ø–æ–ª–Ω—ã–π UnifiedMemoryItem
3. `load_all()` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –ø–æ `agent_namespace`
4. –£–±—Ä–∞—Ç—å –º–∞–ø–ø–∏–Ω–≥ `hierarchical.{tier}` ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `memory_type` –Ω–∞–ø—Ä—è–º—É—é

##### P1.4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–æ–≤ –∏ —Ç–µ—Å—Ç—ã (1 —á–∞—Å)

–ó–∞–¥–∞—á–∏:

1. –û–±–Ω–æ–≤–∏—Ç—å `__init__.py` ‚Äî —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `UnifiedMemoryItem` –≤–º–µ—Å—Ç–æ `MemoryItem`
2. –°–æ–∑–¥–∞—Ç—å –∞–ª–∏–∞—Å `MemoryItem = UnifiedMemoryItem` –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
3. –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã: `tests/agents/test_unified_memory_item.py`
    - `test_serialization_roundtrip` ‚Äî to_dict ‚Üí from_dict –±–µ–∑ –ø–æ—Ç–µ—Ä—å
    - `test_namespace_isolation` ‚Äî —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞–∑–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è
    - `test_backward_compat` ‚Äî —Å—Ç–∞—Ä—ã–π –∫–æ–¥ —Å `MemoryItem` —Ä–∞–±–æ—Ç–∞–µ—Ç

#### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏ P1

- [ ] –ï–¥–∏–Ω—ã–π dataclass –¥–ª—è –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã
- [ ] –ü–æ–ª–µ `agent_namespace` –≤–æ –≤—Å–µ—Ö CRUD –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
- [ ] SQLite-—Å—Ö–µ–º–∞ —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –ø–æ–ª—è –±–µ–∑ –ø–æ—Ç–µ—Ä—å
- [ ] `to_dict() ‚Üí from_dict()` roundtrip = lossless
- [ ] –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (backward compat)
- [ ] –ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã: ‚â•90% coverage –Ω–∞ –º–æ–¥—É–ª—å

---

### –§–∞–∑–∞ P2: MCP-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–∞–º—è—Ç–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL  
**–°—Ä–æ–∫:** 6-8 —á–∞—Å–æ–≤  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** P1 (UnifiedMemoryItem)

#### –¶–µ–ª—å

–î–∞—Ç—å –∞–≥–µ–Ω—Ç–∞–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å **—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ** —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å –ø–∞–º—è—Ç—å —á–µ—Ä–µ–∑ MCP-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∏ –±—ç–∫—Ç–µ—Å—Ç–æ–≤.

#### –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç

##### P2.1. –°–æ–∑–¥–∞–Ω–∏–µ MCP tool —Ñ–∞–π–ª–∞ (3 —á–∞—Å–∞)

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `backend/agents/mcp/tools/memory.py`

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:

```python
async def memory_store(
    content: str,
    memory_type: str = "episodic",     # working/episodic/semantic/procedural
    importance: float = 0.5,
    tags: list[str] | None = None,
    namespace: str = "shared",
    source: str | None = None,
) -> dict[str, Any]:
    """Store content in agent memory with specified tier and importance."""

async def memory_recall(
    query: str,
    memory_type: str | None = None,     # None = search all tiers
    top_k: int = 5,
    min_importance: float = 0.0,
    tags: list[str] | None = None,
    namespace: str | None = None,
    use_semantic: bool = True,
) -> dict[str, Any]:
    """Recall memories matching query with optional filters."""

async def memory_get_stats(
    namespace: str | None = None,
) -> dict[str, Any]:
    """Get memory system statistics: counts, utilization, tier health."""

async def memory_consolidate() -> dict[str, Any]:
    """Trigger manual memory consolidation (working‚Üíepisodic‚Üísemantic)."""

async def memory_forget(
    min_age_hours: float = 24.0,
    max_importance: float = 0.1,
) -> dict[str, Any]:
    """Trigger intelligent forgetting of low-value memories."""
```

##### P2.2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (1 —á–∞—Å)

**–§–∞–π–ª:** `backend/agents/mcp/tools/__init__.py`

–ó–∞–¥–∞—á–∏:

1. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ 5 memory tools
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ MCP registry
3. –î–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏—è –∏ parameter schemas

##### P2.3. Singleton HierarchicalMemory (1 —á–∞—Å)

**–§–∞–π–ª:** `backend/agents/memory/hierarchical_memory.py`

–ó–∞–¥–∞—á–∏:

1. –°–æ–∑–¥–∞—Ç—å `get_global_memory() -> HierarchicalMemory` singleton
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ —Å SQLiteBackendAdapter
3. MCP tools –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ—Ç singleton

##### P2.4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤ –∞–≥–µ–Ω—Ç–æ–≤ (1 —á–∞—Å)

**–§–∞–π–ª—ã:** `backend/agents/prompts/templates.py`, `backend/agents/consensus/real_llm_deliberation.py`

–ó–∞–¥–∞—á–∏:

1. –û–±–Ω–æ–≤–∏—Ç—å `MEMORY_SYSTEM_DOCS` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ MCP tools
2. –û–±–Ω–æ–≤–∏—Ç—å `AGENT_SYSTEM_PROMPTS` ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é memory tools
3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –≤—ã–∑–æ–≤–æ–≤ –≤ –ø—Ä–æ–º–ø—Ç—ã

##### P2.5. –¢–µ—Å—Ç—ã MCP Memory Tools (2 —á–∞—Å–∞)

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `tests/agents/test_mcp_memory_tools.py`

–¢–µ—Å—Ç—ã:

- `test_memory_store_and_recall` ‚Äî store ‚Üí recall roundtrip
- `test_memory_namespace_isolation` ‚Äî –∞–≥–µ–Ω—Ç DeepSeek –Ω–µ –≤–∏–¥–∏—Ç –ø–∞–º—è—Ç—å Qwen
- `test_memory_stats` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–π
- `test_memory_consolidate` ‚Äî —Ä—É—á–Ω–æ–π –≤—ã–∑–æ–≤ –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏–∏
- `test_memory_forget` ‚Äî –æ—á–∏—Å—Ç–∫–∞ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º
- `test_memory_store_validation` ‚Äî –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Üí –æ—à–∏–±–∫–∞

#### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏ P2

- [ ] 5 MCP tools –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –∞–≥–µ–Ω—Ç–∞–º
- [ ] –ê–≥–µ–Ω—Ç –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å `memory_store()` ‚Üí `memory_recall()` –∏ –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- [ ] Namespace isolation: agent_A –Ω–µ –≤–∏–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ agent_B
- [ ] –ü—Ä–æ–º–ø—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- [ ] –¢–µ—Å—Ç—ã: ‚â•95% coverage –Ω–∞ MCP memory tools
- [ ] –ê–≥–µ–Ω—Ç—Å–∫–∏–π —Ç–µ—Å—Ç (—Å–∫—Ä–∏–ø—Ç): –≤—Å–µ 3 –∞–≥–µ–Ω—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å tools

---

### –§–∞–∑–∞ P3: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä —Ç–µ–≥–æ–≤ + –∞–≤—Ç–æ-—Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° HIGH  
**–°—Ä–æ–∫:** 8-10 —á–∞—Å–æ–≤  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** P1 (UnifiedMemoryItem), P2 (MCP tools)

#### –¶–µ–ª—å

–£—Å—Ç—Ä–∞–Ω–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏–∏ EPISODIC‚ÜíSEMANTIC –ø—É—Ç—ë–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ–≥–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.

#### –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç

##### P3.1. TagNormalizer (3 —á–∞—Å–∞)

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `backend/agents/memory/tag_normalizer.py`

```python
class TagNormalizer:
    """
    Normalizes tags to canonical form with synonym resolution.

    Examples:
        "RSI" ‚Üí "rsi"
        "RSI_indicator" ‚Üí "rsi"
        "relative-strength-index" ‚Üí "rsi"
        "Trading" ‚Üí "trading"
        "trade" ‚Üí "trading"
    """

    # –ü—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã —Å–∏–Ω–æ–Ω–∏–º–æ–≤
    SYNONYM_GROUPS: dict[str, list[str]] = {
        "rsi": ["rsi_indicator", "relative-strength-index", "relative_strength_index"],
        "macd": ["macd_indicator", "moving-average-convergence-divergence"],
        "trading": ["trade", "trades", "trader"],
        "backtest": ["backtesting", "back-test", "back_test"],
        "strategy": ["strategies", "strat", "trading_strategy"],
        "optimization": ["optimize", "optimizer", "optimizing"],
        "risk": ["risk_management", "risk-management"],
        # ... —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π —Å–ø–∏—Å–æ–∫
    }

    def normalize(self, tag: str) -> str:
        """Normalize tag to canonical form."""

    def normalize_list(self, tags: list[str]) -> list[str]:
        """Normalize and deduplicate a list of tags."""

    def add_synonym(self, canonical: str, synonym: str) -> None:
        """Register new synonym at runtime."""

    def get_canonical(self, tag: str) -> str:
        """Get canonical form, or lowercase original if unknown."""
```

–ó–∞–¥–∞—á–∏:

1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å lookup –ø–æ synonym groups
2. Case-insensitive + strip + replace [-_ ] ‚Üí –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
4. –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å: `add_synonym()` –¥–ª—è runtime-–¥–æ–±–∞–≤–ª–µ–Ω–∏—è

##### P3.2. AutoTagger (3 —á–∞—Å–∞)

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `backend/agents/memory/auto_tagger.py`

```python
class AutoTagger:
    """
    Automatically generates tags from content and metadata.

    Strategies:
    1. Keyword extraction (TF-IDF like)
    2. Metadata-based (source ‚Üí tag, memory_type ‚Üí tag)
    3. Pattern matching (regex for known entities: symbols, indicators)
    """

    # –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –∞–≤—Ç–æ-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
    PATTERNS: dict[str, re.Pattern] = {
        "symbol": re.compile(r'\b[A-Z]{2,6}USDT\b'),          # BTCUSDT, ETHUSDT
        "indicator": re.compile(r'\b(RSI|MACD|BB|EMA|SMA|ATR)\b', re.I),
        "timeframe": re.compile(r'\b(1m|5m|15m|1h|4h|1d|1w)\b', re.I),
    }

    def generate_tags(
        self,
        content: str,
        metadata: dict[str, Any] | None = None,
        source: str | None = None,
        existing_tags: list[str] | None = None,
    ) -> list[str]:
        """Generate tags from content, metadata, and source."""

    def extract_keywords(self, content: str, top_k: int = 5) -> list[str]:
        """Extract top keywords using simple TF weighting."""
```

–ó–∞–¥–∞—á–∏:

1. Regex-–ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è —Ç—Ä–µ–π–¥–∏–Ω–≥–æ–≤—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π (—Å–∏–º–≤–æ–ª—ã, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã, —Ç–∞–π–º—Ñ—Ä–µ–π–º—ã)
2. Keyword extraction (word frequency, stop words)
3. Metadata mapping: `source="deepseek"` ‚Üí tag `"agent:deepseek"`
4. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å existing_tags + –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ TagNormalizer

##### P3.3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ HierarchicalMemory.store() (1 —á–∞—Å)

**–§–∞–π–ª:** `backend/agents/memory/hierarchical_memory.py`

–ó–∞–¥–∞—á–∏:

1. –í `store()` ‚Äî –≤—ã–∑—ã–≤–∞—Ç—å `AutoTagger.generate_tags()` –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
2. –í `store()` ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –í–°–ï —Ç–µ–≥–∏ —á–µ—Ä–µ–∑ `TagNormalizer.normalize_list()`
3. –í `consolidate()` ‚Äî –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ **canonical tags** (–Ω–µ raw tags)

##### P3.4. –¢–µ—Å—Ç—ã (2 —á–∞—Å–∞)

**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:**

- `tests/agents/test_tag_normalizer.py`
- `tests/agents/test_auto_tagger.py`

–¢–µ—Å—Ç—ã:

- `test_synonym_resolution` ‚Äî "RSI_indicator" ‚Üí "rsi"
- `test_case_insensitive` ‚Äî "Trading" = "trading"
- `test_deduplication` ‚Äî ["rsi", "RSI", "rsi_indicator"] ‚Üí ["rsi"]
- `test_auto_tag_symbols` ‚Äî "BTCUSDT price analysis" ‚Üí ["btcusdt"]
- `test_auto_tag_indicators` ‚Äî "RSI crossed above 70" ‚Üí ["rsi"]
- `test_consolidation_unblocked` ‚Äî 3 —ç–ª–µ–º–µ–Ω—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–µ–≥–∞–º–∏ ‚Üí –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è ‚Üí –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

#### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏ P3

- [ ] TagNormalizer: ‚â•20 synonym groups –¥–ª—è —Ç—Ä–µ–π–¥–∏–Ω–≥-–¥–æ–º–µ–Ω–∞
- [ ] AutoTagger: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ symbols, indicators, timeframes
- [ ] –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è EPISODIC‚ÜíSEMANTIC —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω—ã–º–∏ —Ç–µ–≥–∞–º–∏
- [ ] –ù–µ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –≤ store()/recall()/consolidate()
- [ ] –¢–µ—Å—Ç—ã: ‚â•95% coverage –Ω–∞ TagNormalizer + AutoTagger
- [ ] –î–µ–º–æ: 3 —ç–ª–µ–º–µ–Ω—Ç–∞ –æ—Ç —Ä–∞–∑–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ ‚Üí canonical tags —Å–æ–≤–ø–∞–¥–∞—é—Ç ‚Üí –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç

---

### –§–∞–∑–∞ P4: –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ (Hybrid Retrieval)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° HIGH  
**–°—Ä–æ–∫:** 10-12 —á–∞—Å–æ–≤  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** P1 (UnifiedMemoryItem), P3 (normalized tags)

#### –¶–µ–ª—å

–ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π –¥–≤—É—Ö–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–π –ø–æ–∏—Å–∫ (keyword 30% + cosine 50%) –Ω–∞ —Ç—Ä—ë—Ö—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π –≥–∏–±—Ä–∏–¥–Ω—ã–π pipeline –ø–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ GAM/Repos research.

#### –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç

##### P4.1. Structured Filter Stage (2 —á–∞—Å–∞)

**–§–∞–π–ª:** `backend/agents/memory/hierarchical_memory.py`

–ó–∞–¥–∞—á–∏:

1. –í—ã–¥–µ–ª–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ tier, namespace, importance, tags –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ `_structured_filter()`
2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–æ scoring (—É–º–µ–Ω—å—à–∞–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –¥–ª—è –¥–æ—Ä–æ–≥–æ–≥–æ similarity)
3. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ composite —Ñ–∏–ª—å—Ç—Ä–æ–≤: `tier=SEMANTIC AND namespace=deepseek AND importance>=0.5`

##### P4.2. BM25 Keyword Ranking (3 —á–∞—Å–∞)

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `backend/agents/memory/bm25_ranker.py`

```python
class BM25Ranker:
    """
    BM25 (Best Matching 25) keyword ranker.

    Replaces simple word overlap with proper TF-IDF-like ranking:
    - Term frequency saturation (k1=1.2)
    - Document length normalization (b=0.75)
    - IDF weighting
    """

    def __init__(self, k1: float = 1.2, b: float = 0.75):
        self.k1 = k1
        self.b = b
        self._corpus: list[list[str]] = []
        self._doc_freqs: dict[str, int] = {}
        self._avg_dl: float = 0.0

    def index(self, documents: list[str]) -> None:
        """Build BM25 index from documents."""

    def score(self, query: str, document_idx: int) -> float:
        """Score a single document against query."""

    def rank(self, query: str, candidate_indices: list[int], top_k: int = 20) -> list[tuple[int, float]]:
        """Rank candidates by BM25 score."""
```

–ó–∞–¥–∞—á–∏:

1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å BM25 scoring (–±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, ~100 —Å—Ç—Ä–æ–∫)
2. Tokenization: simple whitespace + lowercase + strip punctuation
3. Incremental indexing: –æ–±–Ω–æ–≤–ª—è—Ç—å –∏–Ω–¥–µ–∫—Å –ø—Ä–∏ store/delete
4. Thread-safe: asyncio.Lock –¥–ª—è concurrent access

##### P4.3. Vector Similarity —Å —è–≤–Ω–æ–π –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–µ–π (2 —á–∞—Å–∞)

**–§–∞–π–ª:** `backend/agents/memory/vector_store.py`

–ó–∞–¥–∞—á–∏:

1. –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ ChromaDB ‚Üí `logger.warning("‚ö†Ô∏è VectorStore degraded: keyword-only mode")`
2. –ú–µ—Ç—Ä–∏–∫–∞ `memory_vector_store_degraded: bool` –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
3. –ï—Å–ª–∏ embeddings –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `score=0.0` (–Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å —Å—Ç–∞–¥–∏—é)
4. –î–æ–±–∞–≤–∏—Ç—å `is_degraded() -> bool` property

##### P4.4. Fusion Scoring + Re-ranking (2 —á–∞—Å–∞)

**–§–∞–π–ª:** `backend/agents/memory/hierarchical_memory.py` (–æ–±–Ω–æ–≤–∏—Ç—å `_calculate_relevance`)

–ù–æ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞:

```
final_score = w1 √ó bm25_score + w2 √ó cosine_similarity + w3 √ó importance + w4 √ó recency
```

–ì–¥–µ:

- `w1 = 0.35` (BM25, –∑–∞–º–µ–Ω—è–µ—Ç keyword overlap)
- `w2 = 0.40` (cosine similarity, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω, –∏–Ω–∞—á–µ 0)
- `w3 = 0.15` (importance factor)
- `w4 = 0.10` (recency decay)

–ï—Å–ª–∏ vector store degraded: –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å `w2 ‚Üí w1`:

```
w1 = 0.65, w2 = 0.0, w3 = 0.20, w4 = 0.15
```

##### P4.5. –¢–µ—Å—Ç—ã Hybrid Retrieval (3 —á–∞—Å–∞)

**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:**

- `tests/agents/test_bm25_ranker.py`
- `tests/agents/test_hybrid_retrieval.py`

–¢–µ—Å—Ç—ã:

- `test_bm25_basic_scoring` ‚Äî known query/document pairs
- `test_bm25_ranking_order` ‚Äî –±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤—ã—à–µ
- `test_hybrid_full_pipeline` ‚Äî structured ‚Üí BM25 ‚Üí vector ‚Üí fusion
- `test_hybrid_degraded_mode` ‚Äî –±–µ–∑ ChromaDB, BM25 weight —É–≤–µ–ª–∏—á–µ–Ω
- `test_hybrid_vs_old_recall` ‚Äî –Ω–æ–≤—ã–π recall ‚â• —Å—Ç–∞—Ä–æ–≥–æ –ø–æ quality (benchmark)
- `test_recall_latency` ‚Äî <100ms –¥–ª—è 1000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤

#### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏ P4

- [ ] BM25 ranker: –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π scoring –Ω–∞ benchmark dataset
- [ ] 3-stage pipeline: structured ‚Üí BM25 ‚Üí vector ‚Üí fusion
- [ ] Degraded mode: —è–≤–Ω—ã–π warning + per–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤
- [ ] Recall quality: ‚â• —Ç–µ–∫—É—â–µ–≥–æ baseline –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –∫–æ—Ä–ø—É—Å–µ
- [ ] Latency: <100ms –¥–ª—è recall –Ω–∞ 1000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- [ ] –¢–µ—Å—Ç—ã: ‚â•90% coverage –Ω–∞ –Ω–æ–≤—ã–µ –º–æ–¥—É–ª–∏

---

### –§–∞–∑–∞ P5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ –≤ –¥–µ–ª–∏–±–µ—Ä–∞—Ü–∏—é

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ MEDIUM  
**–°—Ä–æ–∫:** 8-10 —á–∞—Å–æ–≤  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** P1, P2, P3, P4 (–≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ñ–∞–∑—ã)

#### –¶–µ–ª—å

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–æ–≥–∞—â–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–µ–ª–∏–±–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –ø–∞–º—è—Ç–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞ –æ–±—Ä–∞—Ç–Ω–æ –≤ SEMANTIC/PROCEDURAL memory.

#### –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç

##### P5.1. Auto-Recall –ø–µ—Ä–µ–¥ –¥–µ–ª–∏–±–µ—Ä–∞—Ü–∏–µ–π (3 —á–∞—Å–∞)

**–§–∞–π–ª:** `backend/agents/consensus/real_llm_deliberation.py`

–ó–∞–¥–∞—á–∏:

1. –í `deliberate()` ‚Äî –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∑–∞–ø—Ä–æ—Å–∞ –∞–≥–µ–Ω—Ç–∞–º:

    ```python
    relevant_memories = await memory.recall(
        query=topic_description,
        memory_type=None,  # –≤—Å–µ tier
        top_k=5,
        min_importance=0.3,
        namespace=agent_name,
    )
    ```

2. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å memories –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ –ø—Ä–æ–º–ø—Ç–µ:

    ```
    ## Relevant Prior Knowledge
    1. [SEMANTIC, importance=0.8] RSI above 70 is overbought...
    2. [EPISODIC, importance=0.6] Last BTCUSDT backtest showed...
    ```

3. –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `use_memory: bool = True` –≤ `deliberate()`

##### P5.2. Auto-Store –ø–æ—Å–ª–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞ (2 —á–∞—Å–∞)

**–§–∞–π–ª:** `backend/agents/consensus/real_llm_deliberation.py`

–ó–∞–¥–∞—á–∏:

1. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ `deliberate()` ‚Äî —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

    ```python
    await memory.store(
        content=consensus_result.summary,
        memory_type=MemoryType.EPISODIC,
        importance=consensus_result.confidence,
        tags=auto_tagger.generate_tags(consensus_result.summary),
        source="deliberation",
        metadata={"agents": participating_agents, "topic": topic},
        namespace="shared",
    )
    ```

2. –í—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å—ã (confidence ‚â• 0.8) ‚Üí —Å—Ä–∞–∑—É –≤ SEMANTIC

##### P5.3. Memory Context –≤ ConsensusEngine (2 —á–∞—Å–∞)

**–§–∞–π–ª:** `backend/agents/consensus/consensus_engine.py`

–ó–∞–¥–∞—á–∏:

1. `build_context()` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª "Prior Consensus Results"
2. –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–≥—É `"deliberation"` + —Ç–µ–º–µ ‚Üí inject –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç
3. –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è: –Ω–µ inject —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏

##### P5.4. –¢–µ—Å—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (3 —á–∞—Å–∞)

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `tests/agents/test_memory_deliberation_integration.py`

–¢–µ—Å—Ç—ã:

- `test_auto_recall_before_deliberation` ‚Äî memories injection –≤ –ø—Ä–æ–º–ø—Ç
- `test_auto_store_after_consensus` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ EPISODIC
- `test_high_confidence_to_semantic` ‚Äî confidence‚â•0.8 ‚Üí SEMANTIC tier
- `test_memory_informed_deliberation` ‚Äî second deliberation on same topic uses prior knowledge
- `test_deliberation_without_memory` ‚Äî `use_memory=False` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
- `test_no_duplicate_injection` ‚Äî —Ç–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ inject

#### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏ P5

- [ ] –î–µ–ª–∏–±–µ—Ä–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—É—é –ø–∞–º—è—Ç—å
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏
- [ ] –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –¥–µ–ª–∏–±–µ—Ä–∞—Ü–∏—è –ø–æ —Ç–µ–º–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—à–ª—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- [ ] `use_memory=False` ‚Äî –ø–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- [ ] –¢–µ—Å—Ç—ã: ‚â•90% coverage –Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
- [ ] E2E —Ç–µ—Å—Ç: 2 —Ä–∞—É–Ω–¥–∞ –¥–µ–ª–∏–±–µ—Ä–∞—Ü–∏–∏ ‚Üí –≤—Ç–æ—Ä–æ–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–≤—ã–π

---

## 6. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ü–µ–ª–µ–≤–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è

### 6.1. –î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```
                         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                         ‚îÇ  LLM Agents   ‚îÇ
                         ‚îÇ (DeepSeek,    ‚îÇ
                         ‚îÇ  Qwen,        ‚îÇ
                         ‚îÇ  Perplexity)  ‚îÇ
                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ MCP Protocol
                         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                         ‚îÇ  MCP Memory   ‚îÇ
                         ‚îÇ   Tools (P2)  ‚îÇ
                         ‚îÇ store/recall/ ‚îÇ
                         ‚îÇ stats/forget  ‚îÇ
                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ   HierarchicalMemory    ‚îÇ
                    ‚îÇ         v2              ‚îÇ
                    ‚îÇ                         ‚îÇ
                    ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
                    ‚îÇ ‚îÇ UnifiedMemoryItem   ‚îÇ ‚îÇ ‚Üê P1
                    ‚îÇ ‚îÇ (single dataclass)  ‚îÇ ‚îÇ
                    ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
                    ‚îÇ                         ‚îÇ
                    ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
                    ‚îÇ ‚îÇ TagNormalizer +      ‚îÇ ‚îÇ ‚Üê P3
                    ‚îÇ ‚îÇ AutoTagger          ‚îÇ ‚îÇ
                    ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
                    ‚îÇ                         ‚îÇ
                    ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
                    ‚îÇ ‚îÇ Hybrid Retrieval    ‚îÇ ‚îÇ ‚Üê P4
                    ‚îÇ ‚îÇ Structured‚ÜíBM25‚ÜíVec ‚îÇ ‚îÇ
                    ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ        ‚îÇ
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ SQLiteBackend ‚îÇ  ‚îÇ VectorStore      ‚îÇ
              ‚îÇ (unified      ‚îÇ  ‚îÇ (ChromaDB +      ‚îÇ
              ‚îÇ  schema)      ‚îÇ  ‚îÇ  degradation     ‚îÇ
              ‚îÇ               ‚îÇ  ‚îÇ  warning)        ‚îÇ
              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ   Deliberation          ‚îÇ ‚Üê P5
                    ‚îÇ   Integration           ‚îÇ
                    ‚îÇ auto_recall + auto_store ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 6.2. –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

#### –ü–æ—Ç–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (Store Flow)

```
Agent ‚Üí MCP memory_store(content, tags, namespace)
    ‚Üí AutoTagger.generate_tags(content, metadata)
    ‚Üí TagNormalizer.normalize_list(all_tags)
    ‚Üí HierarchicalMemory.store(unified_item)
        ‚Üí embedding_fn(content) ‚Üí embedding
        ‚Üí SQLiteBackend.save_item(unified_item)
        ‚Üí VectorStore.add(id, content, embedding)
    ‚Üí return {id, status: "stored"}
```

#### –ü–æ—Ç–æ–∫ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è (Recall Flow)

```
Agent ‚Üí MCP memory_recall(query, filters)
    ‚Üí HierarchicalMemory.recall(query, namespace)
        ‚Üí Stage 1: _structured_filter(tier, namespace, importance, tags)
        ‚Üí Stage 2: BM25Ranker.rank(query, candidates)
        ‚Üí Stage 3: VectorStore.query(embedding, candidates) [if available]
        ‚Üí Stage 4: fusion_score(bm25, cosine, importance, recency)
        ‚Üí top_k results
    ‚Üí return [{id, content, score, tier, tags}]
```

#### –ü–æ—Ç–æ–∫ –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏–∏ (Consolidation Flow)

```
MemoryConsolidator._run_loop() [every 1 hour]
    ‚Üí consolidate():
        ‚Üí WORKING items with importance ‚â• 0.7 ‚Üí copy to EPISODIC
        ‚Üí Group EPISODIC by canonical_tags (via TagNormalizer)
        ‚Üí Groups with ‚â• 3 items AND avg_importance ‚â• 0.6
            ‚Üí _create_semantic_summary(items) ‚Üí SEMANTIC
    ‚Üí forget():
        ‚Üí TTL-expired items ‚Üí delete
        ‚Üí importance < 0.1 AND access_count < 2 ‚Üí delete
        ‚Üí decay: importance -= 0.001/hour since last access
```

---

## 7. –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

### 7.1. –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞                               | AS-IS      | –¶–µ–ª–µ–≤–æ–µ                           | –§–∞–∑–∞ |
| ------------------------------------- | ---------- | --------------------------------- | ---- |
| Dataclass'–æ–≤ –¥–ª—è memory item          | 2          | 1                                 | P1   |
| MCP tools –¥–ª—è –ø–∞–º—è—Ç–∏                  | 0          | 5                                 | P2   |
| Synonym groups (—Ç–µ–≥–æ–≤)                | 0          | ‚â•20                               | P3   |
| –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è EPISODIC‚ÜíSEMANTIC        | ‚ùå blocked | ‚úÖ working                        | P3   |
| Stages –≤ recall pipeline              | 2          | 4 (structured+BM25+vector+fusion) | P4   |
| Recall latency (1000 items)           | ~50ms      | <100ms                            | P4   |
| Degradation detection                 | silent     | explicit warning + metric         | P4   |
| Memory context –≤ deliberation         | 0%         | 100% auto                         | P5   |
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –∑—Ä–µ–ª–æ—Å—Ç—å (agent rating) | 5-6/10     | 8/10                              | P5   |

### 7.2. –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞                         | –ö–∞–∫ –∏–∑–º–µ—Ä—è—Ç—å                                     |
| ------------------------------- | ------------------------------------------------ |
| –ê–≥–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç memory tools  | –ê–≥–µ–Ω—Ç—Å–∫–∏–π —Ç–µ—Å—Ç: 3/3 –∞–≥–µ–Ω—Ç–∞ –≤—ã–∑—ã–≤–∞—é—Ç store/recall |
| –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –¥–µ–ª–∏–±–µ—Ä–∞—Ü–∏–∏ –±—ã—Å—Ç—Ä–µ–µ   | –°—Ä–∞–≤–Ω–∏—Ç—å –≤—Ä–µ–º—è 1-–π vs 2-–π –¥–µ–ª–∏–±–µ—Ä–∞—Ü–∏–∏ –ø–æ —Ç–µ–º–µ    |
| –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∑–Ω–∞–Ω–∏—è —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è | SEMANTIC tier count > 0 –ø–æ—Å–ª–µ 24h —Ä–∞–±–æ—Ç—ã         |
| –ö–∞—á–µ—Å—Ç–≤–æ recall —É–ª—É—á—à–∏–ª–æ—Å—å      | A/B —Ç–µ—Å—Ç: hybrid vs old –Ω–∞ benchmark queries     |

---

## 8. –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

| #   | –†–∏—Å–∫                                             | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ     | –ú–∏—Ç–∏–≥–∞—Ü–∏—è                                 |
| --- | ------------------------------------------------ | ----------- | ----------- | ----------------------------------------- |
| R1  | –ú–∏–≥—Ä–∞—Ü–∏—è SQLite-—Å—Ö–µ–º—ã –ª–æ–º–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ | –°—Ä–µ–¥–Ω—è—è     | –í—ã—Å–æ–∫–æ–µ     | Backup –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π + rollback script  |
| R2  | BM25 –∏–Ω–¥–µ–∫—Å —Ä–∞—Å—Ç—ë—Ç –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ >10K —ç–ª–µ–º–µ–Ω—Ç–∞—Ö   | –ù–∏–∑–∫–∞—è      | –°—Ä–µ–¥–Ω–µ–µ     | –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ + lazy indexing |
| R3  | AutoTagger –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —à—É–º–Ω—ã–µ —Ç–µ–≥–∏                | –°—Ä–µ–¥–Ω—è—è     | –°—Ä–µ–¥–Ω–µ–µ     | Configurable whitelist + manual review    |
| R4  | Memory injection —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç token usage         | –í—ã—Å–æ–∫–∞—è     | –°—Ä–µ–¥–Ω–µ–µ     | top_k=3 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é + max_tokens cap     |
| R5  | ChromaDB –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å PyTorch –≤–µ—Ä—Å–∏—è–º–∏          | –ù–∏–∑–∫–∞—è      | –í—ã—Å–æ–∫–æ–µ     | Pin chromadb version + CI test            |
| R6  | Backward compatibility –Ω–∞—Ä—É—à–µ–Ω–∞                  | –ù–∏–∑–∫–∞—è      | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | MemoryItem alias + deprecation warnings   |

---

## 9. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### 9.1. –ú–µ–∂–¥—É —Ñ–∞–∑–∞–º–∏

```
P1 (UnifiedMemoryItem) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                  ‚îÇ
P2 (MCP Tools) ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ depends ‚îÄ‚î§
                                  ‚îÇ
P3 (Tags) ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ depends ‚îÄ‚î§
                                  ‚îÇ
P4 (Hybrid Retrieval) ‚Üê‚îÄ depends ‚îò
         ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                 ‚îÇ
P5 (Deliberation) ‚Üê‚îÄ‚îÄ depends ‚îÄ‚îÄ‚îò (–≤—Å–µ —Ñ–∞–∑—ã)
```

### 9.2. –í–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

| –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å           | –í–µ—Ä—Å–∏—è | –¢–∏–ø            | –ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è     |
| --------------------- | ------ | -------------- | ------------------ |
| SQLite                | 3.35+  | –°–∏—Å—Ç–µ–º–∞        | P1 ‚Äî JSON, WAL     |
| chromadb              | ‚â•0.4.0 | pip (optional) | P4 ‚Äî vector search |
| sentence-transformers | ‚â•2.2.0 | pip (optional) | P4 ‚Äî embeddings    |
| loguru                | ‚â•0.7.0 | pip (core)     | –í—Å–µ —Ñ–∞–∑—ã ‚Äî logging |

### 9.3. –§–∞–π–ª—ã, –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ–º—ã–µ –ø–æ —Ñ–∞–∑–∞–º

| –§–∞–π–ª                       | P1  | P2  | P3  | P4  | P5  |
| -------------------------- | :-: | :-: | :-: | :-: | :-: |
| `hierarchical_memory.py`   | ‚úèÔ∏è  | ‚úèÔ∏è  | ‚úèÔ∏è  | ‚úèÔ∏è  |  ‚Äî  |
| `sqlite_backend.py`        | ‚úèÔ∏è  |  ‚Äî  |  ‚Äî  |  ‚Äî  |  ‚Äî  |
| `backend_interface.py`     | ‚úèÔ∏è  |  ‚Äî  |  ‚Äî  |  ‚Äî  |  ‚Äî  |
| `vector_store.py`          |  ‚Äî  |  ‚Äî  |  ‚Äî  | ‚úèÔ∏è  |  ‚Äî  |
| `shared_memory.py`         |  ‚Äî  |  ‚Äî  |  ‚Äî  |  ‚Äî  |  ‚Äî  |
| `__init__.py` (memory)     | ‚úèÔ∏è  |  ‚Äî  | ‚úèÔ∏è  |  ‚Äî  |  ‚Äî  |
| `mcp/tools/memory.py`      |  ‚Äî  | üÜï  |  ‚Äî  |  ‚Äî  |  ‚Äî  |
| `mcp/tools/__init__.py`    |  ‚Äî  | ‚úèÔ∏è  |  ‚Äî  |  ‚Äî  |  ‚Äî  |
| `tag_normalizer.py`        |  ‚Äî  |  ‚Äî  | üÜï  |  ‚Äî  |  ‚Äî  |
| `auto_tagger.py`           |  ‚Äî  |  ‚Äî  | üÜï  |  ‚Äî  |  ‚Äî  |
| `bm25_ranker.py`           |  ‚Äî  |  ‚Äî  |  ‚Äî  | üÜï  |  ‚Äî  |
| `templates.py`             |  ‚Äî  | ‚úèÔ∏è  |  ‚Äî  |  ‚Äî  |  ‚Äî  |
| `real_llm_deliberation.py` |  ‚Äî  | ‚úèÔ∏è  |  ‚Äî  |  ‚Äî  | ‚úèÔ∏è  |
| `consensus_engine.py`      |  ‚Äî  |  ‚Äî  |  ‚Äî  |  ‚Äî  | ‚úèÔ∏è  |

‚úèÔ∏è = –∏–∑–º–µ–Ω–µ–Ω–∏–µ, üÜï = –Ω–æ–≤—ã–π —Ñ–∞–π–ª

---

## 10. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ A: –ì–ª–æ—Å—Å–∞—Ä–∏–π

| –¢–µ—Ä–º–∏–Ω            | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ                                                       |
| ----------------- | ----------------------------------------------------------------- |
| **Tier**          | –£—Ä–æ–≤–µ–Ω—å –ø–∞–º—è—Ç–∏ (WORKING ‚Üí EPISODIC ‚Üí SEMANTIC ‚Üí PROCEDURAL)       |
| **Consolidation** | –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ lower-tier –≤ upper-tier                  |
| **Forgetting**    | –£–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ TTL, decay, low importance                  |
| **Namespace**     | –ò–∑–æ–ª—è—Ü–∏—è –ø–∞–º—è—Ç–∏ –ø–æ –∞–≥–µ–Ω—Ç—É (deepseek, qwen, perplexity, shared)    |
| **BM25**          | Best Matching 25 ‚Äî –∞–ª–≥–æ—Ä–∏—Ç–º —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è               |
| **Canonical tag** | –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ —Ç–µ–≥–∞ ("RSI_indicator" ‚Üí "rsi")              |
| **Degradation**   | –†–∞–±–æ—Ç–∞ –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ optional dependencies |
| **MCP**           | Model Context Protocol ‚Äî –ø—Ä–æ—Ç–æ–∫–æ–ª –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è LLM-–∞–≥–µ–Ω—Ç–æ–≤    |

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ B: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞—É–¥–∏—Ç–∞ Phase 13

**–£—á–∞—Å—Ç–Ω–∏–∫–∏:** DeepSeek (deepseek-chat), Qwen (qwen-plus), Perplexity (sonar-pro)  
**–ö–æ–Ω—Å–µ–Ω—Å—É—Å:** 4/4 –ø–æ 5 –ø—Ä–æ–±–ª–µ–º–∞–º

1. ‚ùå Dual MemoryItem dataclasses ‚Äî HIGH
2. ‚ùå No MCP tools for memory ‚Äî HIGH
3. ‚ùå Tag inconsistency blocks consolidation ‚Äî HIGH
4. ‚ö†Ô∏è 3 communication paths without routing ‚Äî MEDIUM
5. ‚ö†Ô∏è VectorStore silent degradation ‚Äî MEDIUM

**–û—Ü–µ–Ω–∫–∞ –∑—Ä–µ–ª–æ—Å—Ç–∏:** 5/10 (DeepSeek), 6/10 (Qwen), 6/10 (Perplexity)

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ C: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏–∑ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è Phase 13b

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:** GAM (Google Agent Memory), Memp (MCP Memory Protocol), Repos (GitHub vector-store repos)

#### –ü—Ä–∏–Ω—è—Ç—å:

- ‚úÖ Background Memorizer (event-driven, –Ω–µ cron) ‚Äî –∏–∑ GAM
- ‚úÖ Multi-method retrieval (structured ‚Üí BM25 ‚Üí vector) ‚Äî –∏–∑ GAM
- ‚úÖ Auto-tagging –∏–∑ metadata ‚Äî –∏–∑ GAM
- ‚úÖ Agent namespaces (per-agent isolation) ‚Äî –∏–∑ Memp
- ‚úÖ Push/Pull MCP tools ‚Äî –∏–∑ Memp
- ‚úÖ Hybrid approach (vector + keyword) ‚Äî –∏–∑ Repos

#### –ù–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å:

- ‚ùå Git-style merge (overkill –¥–ª—è –Ω–∞—à–µ–≥–æ –º–∞—Å—à—Ç–∞–±–∞)
- ‚ùå Pure vector-only (insufficient –¥–ª—è structured data)
- ‚ùå Full GAM Researcher planning (overkill –¥–ª—è trading agent)
- ‚ùå Page Store (RAW data + summaries) ‚Äî –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ

---

> **–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ:**
>
> - Phase 12: Memory System Training (9/9 tests, 222/222 checks, 100%)
> - Phase 13: Multi-Agent Architecture Audit (3 agents, 5 consensus issues)
> - Phase 13b: Research Analysis (GAM/Memp/Repos comparison)
> - –ü—Ä—è–º–æ–π –∞–Ω–∞–ª–∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ (2634 —Å—Ç—Ä–æ–∫–∏ –≤ 6 —Ñ–∞–π–ª–∞—Ö)

---

_–í–µ—Ä—Å–∏—è 1.0 ‚Äî 2026-02-04_
