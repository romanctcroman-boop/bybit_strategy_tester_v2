# Команда: глубокий анализ задачи перед выполнением

Использовать при сложной задаче (>2 файлов, рефакторинг, API, неочевидный объём). Правила: `planning.mdc`, `task-decomposition.mdc`.

## ШАГ 1: Понимание

1. Перефразировать задачу своими словами.
2. Задать уточняющие вопросы, если что-то неясно.
3. Определить критерии успеха (тесты, линт, ручная проверка).

## ШАГ 2: Исследование кодовой базы

- **LS** — структура затронутых директорий.
- **SemanticSearch** — ключевые концепции (где считается RSI, как вызывается движок и т.д.).
- **Grep** — точные имена функций, переменных, импортов.

## ШАГ 3: Граф зависимостей

Формат:

```
[Целевой компонент]
├── Зависит от: [компонент1]
│   ├── Определён: file.py:123
│   └── Используется: [где ещё]
├── Зависит от: [компонент2]
└── Влияет на: [зависимые компоненты]
```

## ШАГ 4: Таблица переменных

| Переменная   | Текущий файл | Строка | Тип   | Будет изменена? |
|--------------|--------------|--------|-------|-----------------|
| …            | …            | …      | …     | Да / Нет        |

## ШАГ 5: План тестирования

- Unit-тесты: какие файлы/модули.
- Интеграционные тесты: какие сценарии.
- Ручная проверка: шаги (если нужно).

## ШАГ 6: Оценка сложности

- **Простая:** 1 файл, <50 строк.
- **Средняя:** 2–3 файла, рефакторинг.
- **Сложная:** >3 файлов, архитектурные изменения — **запросить одобрение плана** перед выполнением.

## Сохранение плана

Сохранить план в `.cursor/plans/[краткое-имя-задачи].md` и запросить подтверждение пользователя перед массовыми правками.
