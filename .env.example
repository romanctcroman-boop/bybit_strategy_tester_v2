# Example environment configuration
# Copy this file to .env and adjust values as needed

# Postgres connection (host Windows tools)
POSTGRES_PORT=5543
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=bybit

# Full SQLAlchemy URL for local backend tools (host)
DATABASE_URL=postgresql://postgres:postgres@127.0.0.1:5543/bybit

# Backend behavior flags
BYBIT_PERSIST_KLINES=0

# Redis settings (for /live websocket and pub/sub)
REDIS_URL=redis://127.0.0.1:6379/0
# Or use host/port/db if REDIS_URL is not set
# REDIS_HOST=127.0.0.1
# REDIS_PORT=6379
# REDIS_DB=0
# Redis channels/streams (optional overrides)
# REDIS_CHANNEL_TICKS=bybit:ticks
# REDIS_CHANNEL_KLINES=bybit:klines
# REDIS_STREAM_TICKS=stream:bybit:ticks
# REDIS_STREAM_KLINES=stream:bybit:klines
# WebSocket reconnect settings
# WS_RECONNECT_DELAY_SEC=1.5
# WS_RECONNECT_DELAY_MAX_SEC=15

# Bybit WebSocket manager (feature flag)
# Enable to auto-start WS background on FastAPI startup
BYBIT_WS_ENABLED=0
BYBIT_WS_SYMBOLS=BTCUSDT
BYBIT_WS_INTERVALS=1

# Alembic autogenerate target (optional)
# ALEMBIC_TARGET_METADATA=backend.models:Base

# Celery configuration (broker/worker)
# Default in dev/tests runs tasks inline (CELERY_EAGER=0 means off). For real workers, set a broker and backend.
# Common brokers: redis://localhost:6379/1 or amqp://guest:guest@localhost:5672//
# Common backend: redis://localhost:6379/2

# Eager mode executes tasks locally, synchronously (useful for tests)
# CELERY_EAGER=1

# Broker & result backend
# CELERY_BROKER_URL=redis://127.0.0.1:6379/1
# CELERY_RESULT_BACKEND=redis://127.0.0.1:6379/2

# Queues, flow control, reliability
# CELERY_TASK_DEFAULT_QUEUE=default
# CELERY_PREFETCH_MULTIPLIER=4
# CELERY_ACKS_LATE=1

# Retry policy (defaults are conservative)
# CELERY_TASK_DEFAULT_RETRY_DELAY=5
# CELERY_TASK_MAX_RETRIES=3

# Per-algorithm queues (optional overrides; default mapping is used if not set)
# CELERY_QUEUE_GRID=optimizations.grid
# CELERY_QUEUE_WALK=optimizations.walk
# CELERY_QUEUE_BAYES=optimizations.bayes

# -------------------------
# Docker Compose defaults
# -------------------------
# Используйте эти значения, если запускаете сервисы внутри docker-compose.
# Скопируйте .env.example в .env и раскомментируйте ниже для контейнеров.
#
# DATABASE_URL=postgresql://postgres:postgres@postgres:5432/bybit
# REDIS_URL=redis://redis:6379/0
# CELERY_BROKER_URL=redis://redis:6379/0
# CELERY_RESULT_BACKEND=redis://redis:6379/1
# CORS_ORIGINS=http://localhost:5173
# BYBIT_WS_ENABLED=0
